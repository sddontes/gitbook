(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-c7ec"],{"/8lg":function(e,t,r){"use strict";r.d(t,"q",function(){return a}),r.d(t,"r",function(){return s}),r.d(t,"e",function(){return n}),r.d(t,"i",function(){return i}),r.d(t,"g",function(){return l}),r.d(t,"u",function(){return u}),r.d(t,"v",function(){return c}),r.d(t,"f",function(){return m}),r.d(t,"a",function(){return d}),r.d(t,"j",function(){return h}),r.d(t,"h",function(){return p}),r.d(t,"l",function(){return f}),r.d(t,"n",function(){return g}),r.d(t,"m",function(){return v}),r.d(t,"k",function(){return b}),r.d(t,"s",function(){return y}),r.d(t,"o",function(){return F}),r.d(t,"p",function(){return w}),r.d(t,"t",function(){return _}),r.d(t,"c",function(){return C}),r.d(t,"d",function(){return L}),r.d(t,"b",function(){return U});var o=r("CcjM");function a(e){return Object(o.a)({url:"bzy-upms/authUser/list",method:"get",params:e})}function s(e){return Object(o.a)({url:"bzy-upms/authUser/findUsersByRoleCode",method:"post",data:e})}function n(e){return Object(o.a)({url:"bzy-upms/authUser/getAllUser",method:"get",params:e})}function i(e){return Object(o.a)({url:"bzy-hotel/hotel/listEffective",method:"post",data:e})}function l(e){return Object(o.a)({url:"bzy-hotel/city/hotelAreaResourceList",method:"get",params:e})}function u(e){return Object(o.a)({url:"bzy-upms/user/hotelResource",method:"post",data:e})}function c(e){return Object(o.a)({url:"bzy-upms/user/hotelResource",method:"put",data:e})}function m(e){return Object(o.a)({url:"bzy-upms/user/hotelResource/getResourcesByUserForm",method:"post",data:e})}function d(e,t,r){var a="1"===e?"bzy-upms/user/hotelResource/"+t:"bzy-upms/user/hotelResource/"+t+"?allocationObject="+r;return Object(o.a)({url:a,method:"delete"})}function h(e){return Object(o.a)({url:"bzy-hotel/resource/getReleation/"+e,method:"get"})}function p(){return Object(o.a)({url:"bzy-upms/department/list",method:"get"})}function f(){return Object(o.a)({url:"bzy-upms/department/getSubDepartmentList",method:"get"})}function g(){return Object(o.a)({url:"bzy-upms/department/getSubUserRoleList",method:"get"})}function v(e){return Object(o.a)({url:"bzy-upms/user/hotelResource/querySubUserHotelResourceList",method:"post",data:e})}function b(){return Object(o.a)({url:"bzy-hotel/resource/getReleationHotelEffective",method:"get"})}function y(){return Object(o.a)({url:"bzy-hotel/city/hotelAreaPermissionResourceList",method:"get"})}function F(e){return Object(o.a)({url:"bzy-upms/theater/subList/"+e,method:"get"})}function w(e){return Object(o.a)({url:"bzy-upms/theater/getTheaterNodeDetails/"+e,method:"get",data:e})}function _(e){return Object(o.a)({url:"/bzy-upms/theater",method:"post",data:e})}function C(e){return Object(o.a)({url:"/bzy-upms/theater",method:"put",data:e})}function L(){return Object(o.a)({url:"bzy-upms/theater/queryAll",method:"get"})}function U(e){return Object(o.a)({url:"bzy-upms/theater/"+e,method:"delete"})}},"32LA":function(e,t,r){"use strict";function o(e){return e.map(function(e){var t=[];return e.children.map(function(e){t.push({name:e.name,code:e.code})}),{name:e.name,code:e.code,children:t}})}function a(e){return e.map(function(e){var t=[];return e.children.map(function(e){t.push({nodeName:e.nodeName,id:e.id})}),{nodeName:e.nodeName,id:e.id,children:t}})}r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a})},"8Acb":function(e,t,r){"use strict";var o=r("4d7F"),a=r.n(o),s=r("vDqi"),n=r.n(s),i=r("XJYT"),l=r("Q2AE"),u=r("kkBN"),c=r("Qyje"),m=r.n(c),d=n.a.create({timeout:5e3});d.interceptors.request.use(function(e){return"get"===e.method&&(e.paramsSerializer=function(e){return m.a.stringify(e,{arrayFormat:"repeat"})}),l.a.getters.token&&(e.headers.Authorization="bearer"+Object(u.a)()),e},function(e){a.a.reject(e)}),d.interceptors.response.use(function(e){var t=e;return 200!==t.status?(Object(i.Message)({message:t.message,type:"error",duration:5e3}),a.a.reject("error")):403===t.data.code?(Object(i.Message)({message:t.data.message,type:"error",duration:5e3}),a.a.reject("error")):401===t.data.code?(i.MessageBox.confirm("你的登录信息已过期，请重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.dispatch("FedLogOut").then(function(){location.reload()})}),a.a.reject("error")):e.data},function(e){switch(e.response.status){case 403:i.MessageBox.confirm("你的登录信息已过期，请重新登录","确定登出",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then(function(){l.a.dispatch("FedLogOut").then(function(){location.reload()})});break;case 500:Object(i.Message)({message:e.response.data.message,type:"error",duration:5e3})}});var h=d,p="http://bzy.hhotel.com",f=p+"/bzy-upms/";t.a={login:function(e){return h({method:"post",url:p+"login",data:e})},logout:function(e){return h({method:"get",url:p+"rios-auth/logouting",params:e})},getLoginUserInfo:function(){return h({method:"post",url:p+"rios-auth/user"})},addMenu:function(e){return h({method:"POST",url:f+"menu",data:e})},getMenuList:function(e){return h({method:"get",url:f+"menu/tree",params:e})},updateMenuList:function(e){return h({method:"PUT",url:f+"menu",data:e})},deleteMenuList:function(e){return h({method:"DELETE",url:f+"menu/"+e})},getAuthUserMenu:function(){return h({method:"GET",url:f+"authUser/findMenu"})},getMenuDetail:function(e){return h({method:"get",url:f+"menu/"+e})},getRoleList:function(){return h({method:"get",url:f+"role/list"})},addRole:function(e){return h({method:"POST",url:f+"role",data:e})},updateRole:function(e){return h({method:"PUT",url:f+"role",data:e})},getRoleDetail:function(e){return h({method:"get",url:f+"role/"+e})},verifyRoleCode:function(e){return h({method:"get",url:f+"role/validateCode/"+e})},verifyRoleName:function(e){return h({method:"get",url:f+"role/validateName/"+e})},deleteRole:function(e){return h({method:"DELETE",url:f+"role/"+e})},getUserList:function(e){return h({method:"get",url:f+"authUser/list",params:e})},addUser:function(e){return h({method:"POST",url:f+"authUser",data:e})},getUser:function(e){return h({method:"GET",url:f+"authUser/"+e})},updateUser:function(e){return h({method:"PUT",url:f+"authUser",data:e})},deleteUser:function(e){return h({method:"DELETE",url:f+"authUser/"+e})},disabledUser:function(e){return h({method:"PUT",url:f+"authUser/forbidden/"+e})},validateUser:function(e){return h({method:"GET",url:f+"authUser/validate",params:e})},getUserInfo:function(){return h({method:"GET",url:f+"authUser/info"})},modifyUserInfo:function(e){return h({method:"PUT",url:f+"authUser/update",data:e})},findRolesByUserId:function(){return h({method:"GET",url:f+"authUser/findRolesByUserId"})},modifyUserPassword:function(e){return h({method:"PUT",url:f+"authUser/updatePassword",data:e})},validatePassword:function(e,t){return h({method:"GET",url:f+"authUser/validatePassword",params:t})},getDepartmentList:function(){return h({method:"get",url:f+"department/list"})}}},AVt7:function(e,t,r){"use strict";var o=r("xFge");r.n(o).a},OMKw:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACdklEQVRYR+2Yv4sTQRTHv29AovgDrPQqGzltYpHMbCT2WongISLaWHnN/QFq7/0BNtpYidp4KNddn9PszEIwjT+uVyvh7kAjm3ky4sJmL5usyW4IYVNm58dn3ve9N28eYc5/lORrt9vLQoh1IroM4FjB/PvMvEVED6WUH4ftNQDY6XSWwzB8D+BkwWDJ5X/0+/2LjUbjc/LDAKDW+jURXQfw1lq76nnetyJBfd8/LYR4AuAaM28opVZGAhpj9pys1tqlouEikG63e6rX6zlD7Espj48DZDdASnnAN4u0pDEmdd8BkFEDS8AU5RbDglrrFhE185CZmbeVUpfia03tg0EQtJh5fgHzsNyoNaa2YAm48HmwjOKFl7iM4lLiKX2gvEmmNCBcMWKtRbLKcevORT046oCZALPcJMPqvETNtwRgDcANAGcA9Jl5h4g2ATyWUn4d+y5Oc9Ys9eAoQK31ChE9A3AixVq7RHS3Xq9vzPxVFwTBTWZ+AUCM8VXLzLeVUq/i4zJJPGkQGGOcrK6lMWA5a+3fkl8I0UqsvQvgfFzuogEfAbifPGD07o5cKvF9XUr5IPqvaMAvAM7+J2BXSnlhVoC/ARxymzlZPc/bHuYuvu83Y3L/klIemRXgTwCH//lbs1arvZsWMNfmkTHmA4BqbhLH2m9vKpXKarVa/T5pBLt5xph8gySvBmaUtF2aYeZPRDTQVhNCNMMwpGSaYeY9IjqXmmbcqWMt4CsAjk5iwfitorW+RUTPMybqO0qpl6mJehKYLHMcJICnSUtGc53lANxLwh2oZrJsNukYJ7cQYs1aezWWG3eEEJvW2mzFwqSbFznvDwSr4Th1V6xnAAAAAElFTkSuQmCC"},VKFn:function(e,t,r){r("bBy9"),r("FlQf"),e.exports=r("ldVq")},jYEY:function(e,t,r){var o;!function(a){"use strict";function s(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function n(e,t,r,o,a,n){return s((i=s(s(t,e),s(o,n)))<<(l=a)|i>>>32-l,r);var i,l}function i(e,t,r,o,a,s,i){return n(t&r|~t&o,e,t,a,s,i)}function l(e,t,r,o,a,s,i){return n(t&o|r&~o,e,t,a,s,i)}function u(e,t,r,o,a,s,i){return n(t^r^o,e,t,a,s,i)}function c(e,t,r,o,a,s,i){return n(r^(t|~o),e,t,a,s,i)}function m(e,t){var r,o,a,n,m;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var d=1732584193,h=-271733879,p=-1732584194,f=271733878;for(r=0;r<e.length;r+=16)o=d,a=h,n=p,m=f,h=c(h=c(h=c(h=c(h=u(h=u(h=u(h=u(h=l(h=l(h=l(h=l(h=i(h=i(h=i(h=i(h,p=i(p,f=i(f,d=i(d,h,p,f,e[r],7,-680876936),h,p,e[r+1],12,-389564586),d,h,e[r+2],17,606105819),f,d,e[r+3],22,-1044525330),p=i(p,f=i(f,d=i(d,h,p,f,e[r+4],7,-176418897),h,p,e[r+5],12,1200080426),d,h,e[r+6],17,-1473231341),f,d,e[r+7],22,-45705983),p=i(p,f=i(f,d=i(d,h,p,f,e[r+8],7,1770035416),h,p,e[r+9],12,-1958414417),d,h,e[r+10],17,-42063),f,d,e[r+11],22,-1990404162),p=i(p,f=i(f,d=i(d,h,p,f,e[r+12],7,1804603682),h,p,e[r+13],12,-40341101),d,h,e[r+14],17,-1502002290),f,d,e[r+15],22,1236535329),p=l(p,f=l(f,d=l(d,h,p,f,e[r+1],5,-165796510),h,p,e[r+6],9,-1069501632),d,h,e[r+11],14,643717713),f,d,e[r],20,-373897302),p=l(p,f=l(f,d=l(d,h,p,f,e[r+5],5,-701558691),h,p,e[r+10],9,38016083),d,h,e[r+15],14,-660478335),f,d,e[r+4],20,-405537848),p=l(p,f=l(f,d=l(d,h,p,f,e[r+9],5,568446438),h,p,e[r+14],9,-1019803690),d,h,e[r+3],14,-187363961),f,d,e[r+8],20,1163531501),p=l(p,f=l(f,d=l(d,h,p,f,e[r+13],5,-1444681467),h,p,e[r+2],9,-51403784),d,h,e[r+7],14,1735328473),f,d,e[r+12],20,-1926607734),p=u(p,f=u(f,d=u(d,h,p,f,e[r+5],4,-378558),h,p,e[r+8],11,-2022574463),d,h,e[r+11],16,1839030562),f,d,e[r+14],23,-35309556),p=u(p,f=u(f,d=u(d,h,p,f,e[r+1],4,-1530992060),h,p,e[r+4],11,1272893353),d,h,e[r+7],16,-155497632),f,d,e[r+10],23,-1094730640),p=u(p,f=u(f,d=u(d,h,p,f,e[r+13],4,681279174),h,p,e[r],11,-358537222),d,h,e[r+3],16,-722521979),f,d,e[r+6],23,76029189),p=u(p,f=u(f,d=u(d,h,p,f,e[r+9],4,-640364487),h,p,e[r+12],11,-421815835),d,h,e[r+15],16,530742520),f,d,e[r+2],23,-995338651),p=c(p,f=c(f,d=c(d,h,p,f,e[r],6,-198630844),h,p,e[r+7],10,1126891415),d,h,e[r+14],15,-1416354905),f,d,e[r+5],21,-57434055),p=c(p,f=c(f,d=c(d,h,p,f,e[r+12],6,1700485571),h,p,e[r+3],10,-1894986606),d,h,e[r+10],15,-1051523),f,d,e[r+1],21,-2054922799),p=c(p,f=c(f,d=c(d,h,p,f,e[r+8],6,1873313359),h,p,e[r+15],10,-30611744),d,h,e[r+6],15,-1560198380),f,d,e[r+13],21,1309151649),p=c(p,f=c(f,d=c(d,h,p,f,e[r+4],6,-145523070),h,p,e[r+11],10,-1120210379),d,h,e[r+2],15,718787259),f,d,e[r+9],21,-343485551),d=s(d,o),h=s(h,a),p=s(p,n),f=s(f,m);return[d,h,p,f]}function d(e){var t,r="",o=32*e.length;for(t=0;t<o;t+=8)r+=String.fromCharCode(e[t>>5]>>>t%32&255);return r}function h(e){var t,r=[];for(r[(e.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var o=8*e.length;for(t=0;t<o;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return r}function p(e){var t,r,o="";for(r=0;r<e.length;r+=1)t=e.charCodeAt(r),o+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return o}function f(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return d(m(h(e),8*e.length))}(f(e))}function v(e,t){return function(e,t){var r,o,a=h(e),s=[],n=[];for(s[15]=n[15]=void 0,a.length>16&&(a=m(a,8*e.length)),r=0;r<16;r+=1)s[r]=909522486^a[r],n[r]=1549556828^a[r];return o=m(s.concat(h(t)),512+8*t.length),d(m(n.concat(o),640))}(f(e),f(t))}function b(e,t,r){return t?r?v(t,e):p(v(t,e)):r?g(e):p(g(e))}void 0===(o=function(){return b}.call(t,r,t,e))||(e.exports=o)}()},"k/8l":function(e,t,r){e.exports={default:r("VKFn"),__esModule:!0}},ldVq:function(e,t,r){var o=r("QMMT"),a=r("UWiX")("iterator"),s=r("SBuE");e.exports=r("WEpk").isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||s.hasOwnProperty(o(t))}},q6RU:function(e,t,r){"use strict";r.r(t);var o=r("sk9p"),a=r.n(o),s=r("8Acb"),n=r("wo1R"),i=r("/8lg"),l=r("kkBN"),u=r("jYEY"),c=r.n(u),m={name:"Users",mixins:[n.a],data:function(){var e=this,t=function(t,r,o){if(""===e.userForm.id){if(!r)return o(new Error("请输入账号密码"));o()}else o()};return{imagePath:r("OMKw"),tempHref:"http://bzyadmin.hhotel.com/download/批量导入用户.xlsx",needAreaData:!1,importFormVisible:!1,errorDialog:!1,errlist:[],limit:1,action:"",headers:{Authorization:"bearer"+Object(l.a)()},reportForm:{name:"",hotelCode:""},formLabelWidth:"120px",pwd:"text",hotels:[],hotelName:"",hotelValue:[],list:[],loading:!1,editDisabled:!1,merchantList:[],userFormVisible:!1,formTitle:"",page:1,size:20,totalElements:0,totalPages:1,userList:[],roleList:[],hotelList:[],departmentList:[],timeDefaultShow:"",searchForm:{account:"",phone:"",name:"",departmentCode:"",roleCode:"",status:"",type:"",cityValue:null},userForm:{id:"",account:"",oldAccount:"",phone:"",oldPhone:"",cityValue:[],name:"",oldName:"",password:"",department:"",ids:[],roleList:[],roles:[],status:"1",type:"",email:"",entryDate:new Date,departureDate:"",userOperationHotelForm:{operationHotelList:[]}},rules:{phone:[{required:!0,message:"请输入手机号",trigger:"change"},{validator:function(t,r,o){if(!r)return o(new Error("请输入手机号"));if(/^1[3|4|5|6|7|8|9]\d{9}$/.test(r)){if(""!==e.userForm.id&&e.userForm.phone===e.userForm.oldPhone)return o();e.validate("PHONE",r,function(e){e?o():o(new Error("手机号已被占用"))})}else o(new Error("请输入正确的手机号"))},trigger:"blur"}],email:[{message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],name:[{required:!0,message:"请输入用户姓名",trigger:"blur"},{validator:function(t,r,o){return r?""!==e.userForm.id&&e.userForm.name===e.userForm.oldName?o():void e.validate("NAME",r,function(e){e?o():o(new Error("用户姓名已被使用"))}):o(new Error("请输入用户姓名"))},trigger:"blur"}],password:[{required:!0,message:"请输入用户密码",trigger:"blur"},{validator:t,trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],updatePassword:[{validator:t,trigger:"blur"}],department:[{required:!0,message:"请选择所属部门",trigger:"change"}],ids:[{required:!0,message:"请选择角色",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],entryDate:[{required:!0,message:"请选择入职日期",trigger:"blur"}],cityValue:[{required:!0,validator:function(t,r,o){var s=a()(e.userForm.cityValue,2),n=s[0],i=s[1];if(!n&&!i)return o(new Error("请选择所在区域"));o()},message:"请选择所在区域",trigger:"change"}]},currentPage4:4}},computed:{},created:function(){var e=this;this.getUserList(),this.getRoleList(),this.getDepartmentList(),this._getHotel(),setTimeout(function(){e.pwd="password"},200),this.action="http://bzy.hhotel.com/bzy-upms/authUser/userDataImport?hotelCode=00021&hotelName=无锡假日酒店"},methods:{selRole:function(e){},removeRole:function(e){var t=this;"新增用户"!==this.formTitle&&Object(i.j)(this.userForm.id).then(function(e){e.data.hasReleations&&t.$message({message:"用户已关联酒店，更换角色前请先解除关联关系",type:"warning"})})},importForm:function(){this.importFormVisible=!0},submitUpload:function(){this.$refs.upload.submit()},uploadError:function(e){var t=JSON.parse(e.message).message.slice(1,-1);this.errlist=t.split(","),this.errorDialog=!0},handleExcelSuccess:function(e,t){this.$message({type:"success",message:"导入数据成功"}),this.$refs.upload.clearFiles(),this.dialogFormVisible=!1},changeType:function(){this.pwd="password"},closeDialog:function(){this.userForm.password="",this.userFormVisible=!1},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,setTimeout(function(){t.loading=!1,t.hotelList=t.hotels.filter(function(t){return t.name.indexOf(e)>-1})},200)):this.hotelList=this.hotels},formatRole:function(e,t){return e.roles.join()},formatDepart:function(e){return e.departmentNameList.join()},formatStatus:function(e,t){return 1===e.status?"正常":"禁用"},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;""===t.userForm.id?t.addUser():t.updateUser()})},resetForm:function(e){void 0!==this.$refs[e]&&this.$refs[e].resetFields()},cancel:function(e,t,r){this.userList[e][r]=!1},cancelSave:function(){this.userFormVisible=!1},handleSizeChange:function(e){this.size=e,this.getUserList()},handleCurrentChange:function(e){this.page=e,this.getUserList("pageChange")},search:function(){this.page=1,this.getUserList()},showAddUser:function(){this.resetForm("userForm"),this.editDisabled=!1,this.userFormVisible=!0,this.formTitle="新增用户",this.userForm.id="",this.hotelValue=[]},showEditUser:function(e){this.editDisabled=!0,this.resetForm("userForm"),this.userFormVisible=!0,this.formTitle="编辑用户";var t=e.id;this.bindHotelList=e.hotelNames||"",this.getUser(t)},getUserList:function(e){var t=this;this.page="pageChange"===e?this.page:1;var r=this.searchForm.cityValue?this.searchForm.cityValue:[],o=a()(r,2),n=o[0],i=o[1],l={account:this.searchForm.account,page:this.page,size:this.size,phone:this.searchForm.phone,name:this.searchForm.name,departmentCode:this.searchForm.departmentCode,roleCode:this.searchForm.roleCode,status:this.searchForm.status,provinceCode:n,cityCode:i,type:""===this.searchForm.type?"":1===this.searchForm.type?"HQ":"MERCHANT"};s.a.getUserList(l).then(function(e){var r=e.data;1===t.page?null===r?(t.userList=[],t.totalElements=0):(t.userList=r.list,t.totalElements=r.totalElements,t.totalPages=r.totalPages):null===r?t.userList=[]:(t.userList=r.list,t.totalElements=r.totalElements,t.totalPages=r.totalPages)}).catch()},getRoleList:function(){var e=this;s.a.getRoleList().then(function(t){e.roleList=t.data}).catch()},getDepartmentList:function(){var e=this;s.a.getDepartmentList().then(function(t){e.departmentList=t.data.children}).catch()},getUser:function(e){var t=this;this.formTitle="编辑用户",s.a.getUser(e).then(function(e){var r=e.data;t.userForm.id=r.id,t.userForm.oldAccount=r.account,t.userForm.name=r.name,t.userForm.oldName=r.name,t.userForm.phone=r.phone,t.userForm.oldPhone=r.phone,t.userForm.remarks=r.remarks,t.userForm.entryDate=r.entryDate,t.userForm.departureDate=r.departureDate,t.userForm.status=r.status+"",r.cityCode?t.userForm.cityValue=[r.provinceCode,r.cityCode]:t.userForm.cityValue=[r.provinceCode],t.userForm.type=""===r.type?"":"HQ"===r.type?"0":"1",t.userForm.email=r.email;for(var o=r.roles,a=[],s=0;s<o.length;s++)a.push(o[s].id);t.userForm.ids=a,t.hotelValue=t._getBindHotelVal(t.hotels,t.bindHotelList)}).catch()},addUser:function(){var e=this,t=a()(this.userForm.cityValue,2),r=t[0],o=t[1],n={phone:this.userForm.phone,name:this.userForm.name,password:c()(this.userForm.password),departmentForm:{code:this.userForm.department},provinceCode:r,cityCode:o,roleList:this._formatRole(this.roleList,this.userForm.ids),status:this.userForm.status,type:0===this.userForm.type?"HQ":"MERCHANT",email:this.userForm.email,entryDate:this.userForm.entryDate,departureDate:this.userForm.departureDate,userOperationHotelForm:{operationHotelList:this._formatSelect()}};s.a.addUser(n).then(function(t){e.$message({message:"新增用户成功",type:"success"}),e.userFormVisible=!1,e.resetForm("userForm"),e.getUserList()}).catch()},updateUser:function(){var e=this,t=a()(this.userForm.cityValue,2),r=t[0],o=t[1],n={id:this.userForm.id,phone:this.userForm.phone,name:this.userForm.name,password:""===this.userForm.password?"":c()(this.userForm.password),departmentForm:{code:this.userForm.department},provinceCode:r,cityCode:o,roleList:this._formatRole(this.roleList,this.userForm.ids),status:this.userForm.status,entryDate:this.userForm.entryDate,departureDate:this.userForm.departureDate,type:""===this.userForm.type?"":0===this.userForm.type?"HQ":"MERCHANT",email:this.userForm.email,userOperationHotelForm:{operationHotelList:this._formatSelect()}};s.a.updateUser(n).then(function(t){e.$message({message:"更新用户成功",type:"success"}),e.userFormVisible=!1,e.resetForm("userForm"),e.getUserList()}).catch()},deleteUser:function(e,t){var r=this;this.userList[e]._pop=!1;var o=this.userList[e].id;s.a.deleteUser(o).then(function(e){r.getUserList()}).catch()},disabledUser:function(e,t){var r=this;this.userList[e]._disabled=!1;var o=this.userList[e].id;s.a.disabledUser(o).then(function(e){r.getUserList()}).catch()},validate:function(e,t,r){var o={validateType:e,text:t},a=void 0;s.a.validateUser(o).then(function(e){a=e.data.hasCanUsable,r(a)}).catch()},_getHotel:function(){var e=this;this.hotels=[];Object(i.i)({}).then(function(t){e.hotels=t.data.hotelList,e.hotelList=e.hotels})},_formatRole:function(e,t){var r=[];return t.map(function(t){e.forEach(function(e,o){e.id===t&&r.push({roleId:e.id,roleCode:e.code})})}),r},_formatSelect:function(){var e=[],t=this.hotelValue,r=this.hotels;return t.map(function(t){r.forEach(function(r,o){r.code===t&&e.push({areaCode:r.areaCode,areaName:r.areaName,cityCode:r.cityCode,cityName:r.cityName,proviceCode:r.proviceCode,proviceName:r.proviceName,bigArea:r.bigArea,cooperationMode:r.cooperationMode,signDate:r.signDate,hotelName:r.name,hotelCode:r.code})})}),e},_getBindHotelVal:function(e,t){var r=[];return t.split(",").map(function(t){e.forEach(function(e,o){e.name===t&&r.push(e.code)})}),r}}},d=(r("AVt7"),r("KHd+")),h=Object(d.a)(m,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"layout",attrs:{id:"user"}},[r("div",{staticClass:"tab-head"},[r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm}},[r("el-row",[r("el-col",{attrs:{span:22}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"账号:"}},[r("el-input",{staticStyle:{width:"168px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.account,callback:function(t){e.$set(e.searchForm,"account",t)},expression:"searchForm.account"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"手机号:"}},[r("el-input",{staticStyle:{width:"168px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.phone,callback:function(t){e.$set(e.searchForm,"phone",t)},expression:"searchForm.phone"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"用户姓名:"}},[r("el-input",{staticStyle:{width:"168px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1)],1)],1),e._v(" "),r("el-col",{attrs:{span:2}},[r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.search()}}},[e._v("查询")])],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:22}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"城市:"}},[r("el-cascader",{staticStyle:{width:"168px"},attrs:{options:e.city,props:e.props,clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.selectCity},model:{value:e.searchForm.cityValue,callback:function(t){e.$set(e.searchForm,"cityValue",t)},expression:"searchForm.cityValue"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"角色:"}},[r("el-select",{staticStyle:{width:"168px"},attrs:{placeholder:"角色"},model:{value:e.searchForm.roleCode,callback:function(t){e.$set(e.searchForm,"roleCode",t)},expression:"searchForm.roleCode"}},[r("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.roleList,function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})],2)],1)],1),e._v(" "),r("el-col",{staticStyle:{"text-align":"left"},attrs:{span:8}},[r("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"账号状态:"}},[r("el-select",{staticStyle:{width:"168px"},attrs:{placeholder:"账号状态"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[r("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),r("el-option",{key:"1",attrs:{label:"正常",value:"1"}}),e._v(" "),r("el-option",{key:"0",attrs:{label:"禁用",value:"0"}})],1)],1)],1)],1)],1)],1)],1),e._v(" "),r("div",{staticStyle:{float:"right"}},[r("div",{staticClass:"btn-right"},[r("span",{on:{click:function(t){e.showAddUser()}}},[e._m(0)]),e._v(" "),r("span",{on:{click:e.importForm}},[r("i",{staticClass:"iconfont iconic_download"}),e._v(" "),r("span",{staticClass:"add"},[e._v("批量导入")])])])]),e._v(" "),r("div",{staticClass:"table-wrap"},[r("el-table",{staticStyle:{width:"100%","border-radius":"8px"},attrs:{data:e.userList,"max-height":"500"}},[r("el-table-column",{attrs:{prop:"name",label:"用户姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"jobNumber",label:"工号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),e._v(" "),r("el-table-column",{attrs:{formatter:e.formatRole,prop:"roles",label:"角色"}}),e._v(" "),r("el-table-column",{attrs:{formatter:e.formatDepart,prop:"departmentNameList",label:"所属部门"}}),e._v(" "),r("el-table-column",{attrs:{formatter:e.formatStatus,prop:"status",label:"账号状态"}}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(r){e.showEditUser(t.row)}}}),e._v(" "),r("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.userList[t.$index]._disabled,callback:function(r){e.$set(e.userList[t.$index],"_disabled",r)},expression:"userList[scope.$index]._disabled"}},[r("p",[e._v("禁用后，该账户将无法登陆系统")]),e._v(" "),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){e.cancel(t.$index,t.row,"_disabled")}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.disabledUser(t.$index,t.row)}}},[e._v("确定")])],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"danger",size:"mini",icon:"el-icon-remove-outline",circle:""},slot:"reference"})],1)]}}])})],1)],1),e._v(" "),r("div",{staticClass:"sum"},[e._v("共计"+e._s(e.totalElements)+"条")]),e._v(" "),r("div",{staticStyle:{"margin-top":"20px","text-align":"right"}},[r("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[20,40,60,80],"page-size":e.size,"page-count":e.totalPages,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{staticStyle:{"min-width":"700px"},attrs:{title:e.formTitle,visible:e.userFormVisible},on:{"update:visible":function(t){e.userFormVisible=t},close:e.closeDialog}},[r("el-form",{ref:"userForm",staticClass:"demo-userForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"name",maxlength:"20"}},[r("el-input",{attrs:{type:"text"},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name","string"==typeof t?t.trim():t)},expression:"userForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号",prop:"phone",maxlength:"11"}},[r("el-input",{model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1),e._v(" "),""===e.userForm.id?r("el-form-item",{attrs:{label:"密码",prop:"password",maxlength:"50"}},[r("el-input",{attrs:{type:e.pwd,"auto-complete":"off"},on:{focus:e.changeType},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1):r("el-form-item",{attrs:{label:"密码",prop:"updatePassword",maxlength:"50"},on:{focus:e.changeType}},[r("el-input",{directives:[{name:"show",rawName:"v-show",value:"编辑用户"==e.formTitle,expression:"formTitle == '编辑用户'"}],attrs:{type:"password","auto-complete":"off"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}}),e._v(" "),r("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"password","auto-complete":"off"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色",prop:"ids"}},[r("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},on:{change:e.selRole,"remove-tag":e.removeRole},model:{value:e.userForm.ids,callback:function(t){e.$set(e.userForm,"ids",t)},expression:"userForm.ids"}},e._l(e.roleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"所在区域:",prop:"cityValue"}},[r("el-cascader",{staticStyle:{width:"260px"},attrs:{options:e.city,props:e.props,clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.selectCity},model:{value:e.userForm.cityValue,callback:function(t){e.$set(e.userForm,"cityValue",t)},expression:"userForm.cityValue"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"实际入职日期",prop:"entryDate"}},[r("el-date-picker",{attrs:{"default-value":e.timeDefaultShow,clearable:!1,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.userForm.entryDate,callback:function(t){e.$set(e.userForm,"entryDate",t)},expression:"userForm.entryDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"实际离职日期"}},[r("el-date-picker",{attrs:{"default-value":e.timeDefaultShow,"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.userForm.departureDate,callback:function(t){e.$set(e.userForm,"departureDate",t)},expression:"userForm.departureDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"账号状态",prop:"status"}},[r("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.userForm.status,callback:function(t){e.$set(e.userForm,"status",t)},expression:"userForm.status"}},[r("el-option",{attrs:{label:"正常",value:"1"}}),e._v(" "),r("el-option",{attrs:{label:"禁用",value:"0"}})],1)],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("userForm")}}},[e._v("保存")]),e._v(" "),r("el-button",{on:{click:function(t){e.cancelSave()}}},[e._v("取消")])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{visible:e.importFormVisible,"show-close":!1,center:!0,title:"导入数据","custom-class":"importFile"},on:{"update:visible":function(t){e.importFormVisible=t}}},[r("el-form",{attrs:{model:e.reportForm}},[r("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"选择文件"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-error":e.uploadError,headers:e.headers,"on-success":e.handleExcelSuccess,"auto-upload":!1,action:e.action,limit:e.limit}},[r("div",{staticClass:"viewFile"},[r("img",{attrs:{src:e.imagePath,alt:"浏览"}}),e._v(" "),r("p",{staticClass:"viewText"},[e._v("浏览")])])])],1),e._v(" "),r("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"下载模板"}},[r("a",{staticStyle:{display:"inline-block",width:"98px",height:"32px","line-height":"32px",background:"rgba(0,96,114,0.1)","border-radius":"4px",color:"#006072","text-align":"center"},attrs:{href:e.tempHref,target:"_blank"}},[e._v("下载模板")])])],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticClass:"btn-dialog-sub",on:{click:function(t){e.importFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{staticClass:"btn-dialog-primary",attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("保 存")])],1)],1),e._v(" "),r("el-dialog",{staticClass:"err_dialog",attrs:{visible:e.errorDialog,title:"错误提示",width:"50%"},on:{"update:visible":function(t){e.errorDialog=t}}},[r("div",{staticClass:"el-message-box__content"},[r("div",{staticClass:"el-message-box__status el-icon-error"}),e._v(" "),r("div",{staticClass:"el-message-box__message"},e._l(e.errlist,function(t,o){return r("p",{key:o},[e._v(e._s(t))])}))]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.errorDialog=!1}}},[e._v("确 定")])],1)])],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{attrs:{icon:"el-icon-plus"}},[t("i",{staticClass:"addIcon"},[this._v("+")]),this._v("新增用户\n        ")])}],!1,null,"698fefc4",null);h.options.__file="list.vue";t.default=h.exports},sk9p:function(e,t,r){"use strict";t.__esModule=!0;var o=s(r("k/8l")),a=s(r("FyfS"));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return function(e,t){var r=[],o=!0,s=!1,n=void 0;try{for(var i,l=(0,a.default)(e);!(o=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){s=!0,n=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw n}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},wo1R:function(e,t,r){"use strict";var o=r("/uL/"),a=r("32LA");t.a={data:function(){return{city:[],hotels:[],needAreaData:!0,props:{value:"code",label:"name",checkStrictly:!0},cityValue:[]}},created:function(){this._getCity()},methods:{selectCity:function(e,t){this.provinceCode=e[0]||"",this.cityCode=e[1]||"",this.areaCode=e[2]||""},_getCity:function(){var e=this;Object(o.g)().then(function(t){e.city=e.needAreaData?t.data:Object(a.b)(t.data)})}}}},xFge:function(e,t,r){}}]);