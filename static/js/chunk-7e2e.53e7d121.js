(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e2e"],{"5OVc":function(t,e,a){},"6aKk":function(t,e,a){"use strict";a.d(e,"p",function(){return s}),a.d(e,"r",function(){return o}),a.d(e,"q",function(){return l}),a.d(e,"o",function(){return i}),a.d(e,"n",function(){return r}),a.d(e,"v",function(){return c}),a.d(e,"a",function(){return u}),a.d(e,"k",function(){return d}),a.d(e,"h",function(){return h}),a.d(e,"l",function(){return m}),a.d(e,"m",function(){return b}),a.d(e,"b",function(){return f}),a.d(e,"d",function(){return p}),a.d(e,"c",function(){return g}),a.d(e,"e",function(){return v}),a.d(e,"j",function(){return y}),a.d(e,"g",function(){return _}),a.d(e,"f",function(){return C}),a.d(e,"s",function(){return A}),a.d(e,"i",function(){return x}),a.d(e,"t",function(){return z}),a.d(e,"u",function(){return w});var n=a("CcjM");function s(t){return Object(n.a)({url:"bzy-csg-settlement/settlementModel/pageList",method:"post",data:t})}function o(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/rule/pageList",method:"post",data:t})}function l(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/rule/detail/"+t,method:"get"})}function i(t){return Object(n.a)({url:"bzy-csg-settlement/bill/list",method:"post",data:t})}function r(t){return Object(n.a)({url:"bzy-csg-settlement/bill/queryBillDetail/"+t,method:"get"})}function c(t){return Object(n.a)({url:"bzy-csg-settlement/dataSync/serviceFeeExcel",method:"post",data:t})}function u(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/mini/achievement",method:"post",data:t})}function d(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/listByMultiselect",method:"post",data:t})}function h(t){return Object(n.a)({url:"bzy-csg-settlement/email/sendLog",method:"post",data:t})}function m(t){return Object(n.a)({url:"bzy-csg-settlement/paybill/pageList",method:"post",data:t})}function b(t){return Object(n.a)({url:"bzy-csg-settlement/email",method:"post",data:t})}function f(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/addBillInfoAdjust",method:"post",data:t})}function p(t){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf?"+t,method:"get"})}function g(t){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf",method:"post",data:t})}function v(t,e){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf/"+t,data:e,method:"put",headers:{"Content-Type":"text/plain;charset=UTF-8"}})}function y(t){return Object(n.a)({url:"bzy-csg-settlement/dataSync/billExtend",method:"post",data:t})}function _(t){return Object(n.a)({url:"bzy-csg-settlement/billExtend/hierarchy",params:t,method:"get"})}function C(t){return Object(n.a)({url:"bzy-csg-settlement/billExtend/hotel",params:t,method:"get"})}function A(t){return Object(n.a)({url:"bzy-csg-settlement/settlementModel/list",data:t,method:"post"})}function x(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/importBillAdjustExcel",data:t,method:"post"})}function z(t){return Object(n.a)({url:"bzy-csg-settlement/transaction/payment",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}function w(t){return Object(n.a)({url:"bzy-csg-settlement/transaction/receipt",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}},FEsV:function(t,e,a){"use strict";var n=a("d5K8");a.n(n).a},MO4u:function(t,e,a){"use strict";var n={name:"FetchSuggestions",props:{hotelList:{type:Array,required:!0},searchTitle:{type:String,required:!0}},data:function(){return{code:"",searchCode:""}},methods:{blurSearch:function(){var t=this;if(this.code){var e=this.hotelList.find(function(e){return e.name===t.code||e.code===t.code});this.searchCode=e?e.code:this.code,this.$emit("getFetchCode",this.searchCode)}else this.$emit("getFetchCode",this.code)},handleSelect:function(t){this.searchCode=t.code,this.$emit("getFetchCode",this.searchCode)},querySearch:function(t,e){var a=this.hotelList;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return e.name.indexOf(t)>-1}}}},s=(a("aT9M"),a("KHd+")),o=Object(s.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-list-item"},[t.searchTitle?a("span",{staticStyle:{display:"inline-block",flex:"0 0 70px","margin-right":"10px","text-align":"right"}},[t._v(t._s(t.searchTitle))]):t._e(),t._v(" "),a("el-autocomplete",{staticStyle:{width:"168px",flex:"0 1 atuo"},attrs:{"fetch-suggestions":t.querySearch,clearable:"","value-key":"name",placeholder:"酒店名称/编号"},on:{select:t.handleSelect,blur:t.blurSearch,clear:t.blurSearch},nativeOn:{change:function(e){return t.blurSearch(e)}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1)},[],!1,null,"cff8e71e",null);o.options.__file="index.vue";e.a=o.exports},OMKw:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACdklEQVRYR+2Yv4sTQRTHv29AovgDrPQqGzltYpHMbCT2WongISLaWHnN/QFq7/0BNtpYidp4KNddn9PszEIwjT+uVyvh7kAjm3ky4sJmL5usyW4IYVNm58dn3ve9N28eYc5/lORrt9vLQoh1IroM4FjB/PvMvEVED6WUH4ftNQDY6XSWwzB8D+BkwWDJ5X/0+/2LjUbjc/LDAKDW+jURXQfw1lq76nnetyJBfd8/LYR4AuAaM28opVZGAhpj9pys1tqlouEikG63e6rX6zlD7Espj48DZDdASnnAN4u0pDEmdd8BkFEDS8AU5RbDglrrFhE185CZmbeVUpfia03tg0EQtJh5fgHzsNyoNaa2YAm48HmwjOKFl7iM4lLiKX2gvEmmNCBcMWKtRbLKcevORT046oCZALPcJMPqvETNtwRgDcANAGcA9Jl5h4g2ATyWUn4d+y5Oc9Ys9eAoQK31ChE9A3AixVq7RHS3Xq9vzPxVFwTBTWZ+AUCM8VXLzLeVUq/i4zJJPGkQGGOcrK6lMWA5a+3fkl8I0UqsvQvgfFzuogEfAbifPGD07o5cKvF9XUr5IPqvaMAvAM7+J2BXSnlhVoC/ARxymzlZPc/bHuYuvu83Y3L/klIemRXgTwCH//lbs1arvZsWMNfmkTHmA4BqbhLH2m9vKpXKarVa/T5pBLt5xph8gySvBmaUtF2aYeZPRDTQVhNCNMMwpGSaYeY9IjqXmmbcqWMt4CsAjk5iwfitorW+RUTPMybqO0qpl6mJehKYLHMcJICnSUtGc53lANxLwh2oZrJsNukYJ7cQYs1aezWWG3eEEJvW2mzFwqSbFznvDwSr4Th1V6xnAAAAAElFTkSuQmCC"},QIeT:function(t,e,a){"use strict";a.r(e);var n=a("6aKk"),s=a("kkBN"),o=a("Q2AE"),l=a("MO4u"),i=a("t2Y8"),r={name:"ShopAssignRecord",components:{FetchSuggestions:l.a},mixins:[i.a],data:function(){return{formLabelWidth:"100px",formInputWidth:"100px",dialogFormVisible:!1,imagePath:a("OMKw"),PATH:"settle-accounts/settle-accounts-List",tempHref:"http://bzyadmin.hhotel.com/download/bzy-csg-settlement/bzy-csg-service-fee.xls",loading:!1,newForm:{},hotelCodeOrName:"",hotelList:[],oosUrl:"",accountDate:"",batchNo:"",code:"",assigns:[],formData:{projectType:"4"},headers:{Authorization:"bearer"+Object(s.a)()},settlementModelIdList:[],settleModule:"",action:"",limit:1,currentPage:1,size:20,totalPages:1,total:0}},created:function(){this.action="https://bzy-fs.hhotel.com/bzy-file-server/uploadfile";var t=new Date,e=t.getMonth();t.getDate()>3?this.batchNo=this.accountDate=t.getFullYear()+""+(e>9?e:"0"+e):this.batchNo=this.accountDate=t.getFullYear()+""+(e-1>9?e-1:"0"+(e-1)),this._getsettleAccountsList(),this._getRemoteData(),this._settlementModelList()},methods:{search:function(){this.currentPage=1;var t=new Date,e=t.getFullYear(),a=t.getDate(),n=t.getMonth()+1;n<11&&!this.accountDate||2019===e&&11===n&&a<4&&!this.accountDate||("2019"===this.accountDate.slice(0,4)&&this.accountDate.slice(4)<10?this.$message.error("抱歉，此账期数据不支持查询 "):this._getsettleAccountsList())},getFetchCode:function(t){this.hotelCodeOrName=t},_getsettleAccountsList:function(){var t=this,e=new Date,a=e.getFullYear(),s=e.getDate(),o=e.getMonth()+1;if((!(o<11)||this.accountDate)&&(!(2019===a&&11===o&&s<4)||this.accountDate)&&!("2019"===this.accountDate.slice(0,4)&&this.accountDate.slice(4)<10)){var l={hotelCodeOrName:this.hotelCodeOrName,settleModule:this.settleModule,batchNo:this.accountDate,page:this.currentPage,size:this.size};this.loading=!0,Object(n.o)(l).then(function(e){t.loading=!1,t.assigns=e.data.list,t.totalPages=e.data.pages,t.total=e.data.total})}},_getRemoteData:function(){var t=this;o.a.dispatch("getHotelList").then(function(e){t.hotelList=e})},_settlementModelList:function(){var t=this;Object(n.s)().then(function(e){t.settlementModelIdList=e.data})},inputFileDialog:function(){this.dialogFormVisible=!0},submitUpload:function(){var t=this,e={batchNo:this.batchNo,oosUrl:this.oosUrl};this.batchNo?this.oosUrl?Object(n.v)(e).then(function(e){t.$message({type:"success",message:e.message}),t.$refs.upload.clearFiles(),t.dialogFormVisible=!1}):this.$message.error("请提交文件"):this.$message.error("请选择账期")},handleExcelSuccess:function(t,e){this.oosUrl=t.data[0].filePath},uploadError:function(t){this.$message({type:"error",message:JSON.parse(t.message).message})},_exportExcel:function(){var t={hotelCodeOrName:this.hotelCodeOrName,batchNo:this.accountDate};if(t.hotelCodeOrName||t.batchNo){var e=Object(s.a)(),a="";for(var n in t)a+=t[n]?"&"+n+"="+t[n]:"&"+n+"=";a=a.substring(1);var o="http://bzy.hhotel.com/bzy-csg-settlement/bill/export?"+(a+="&userId="+this.$store.state.user.userId+"&Authorization="+e);window.open(encodeURI(o),"_blank")}else this.$message.error("酒店名称和所属账期不能同时为空")},_toConfirming:function(t){var e="http://bzy.hhotel.com/bzy-csg-settlement/bill/pdf/"+t.billNo;window.open(encodeURI(e),"_blank")},_toOperating:function(t){this.$router.push({path:"/settle-accounts/settle-accounts-costdetail",query:{billNo:t.billNo}})},handleSizeChange:function(t){this.size=t,this._getsettleAccountsList()},handleCurrentChange:function(t){this.currentPage=t,this._getsettleAccountsList()}}},c=(a("FEsV"),a("KHd+")),u=Object(c.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hotel layout",attrs:{id:"manager"}},[a("div",{staticClass:"tab-head"},[a("div",{staticClass:"tab-head-list"},[a("div",{staticClass:"el-row"},[a("div",{staticClass:"el-col el-col-22"},[a("div",{staticClass:"el-col"},[a("div",{staticClass:"tab-list-item"},[a("fetchSuggestions",{staticStyle:{width:"250px"},attrs:{"hotel-list":t.hotelList,"search-title":"酒店"},on:{getFetchCode:t.getFetchCode}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("所属账期")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"168px",float:"right"},attrs:{type:"month",placeholder:"选择月份",format:"yyyy年MM月","value-format":"yyyyMM"},model:{value:t.accountDate,callback:function(e){t.accountDate=e},expression:"accountDate"}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("结算模式")]),t._v(" "),a("el-select",{staticStyle:{width:"168px"},attrs:{clearable:"",placeholder:"请选择"},model:{value:t.settleModule,callback:function(e){t.settleModule=e},expression:"settleModule"}},t._l(t.settlementModelIdList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),a("span",{staticClass:"left_label"}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])])])])]),t._v(" "),a("div",{staticClass:"table-content"},[t.buttonFilter("settle-accounts",t.btnArr)?a("div",{staticClass:"float-right",on:{click:t._exportExcel}},[a("i",{staticClass:"iconfont iconic_download"}),t._v(" "),a("span",{attrs:{type:"primary"}},[t._v("导出")])]):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.assigns,"max-height":"500","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"billNo",label:"业务结算单编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hotelName",label:"酒店名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.hotelName)+"\n          "),a("br"),t._v("\n          "+t._s(e.row.hotelCode)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"settlementModelName",label:"结算模式"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batchNo",label:"所属账期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.batchNo)+"\n          "),a("br"),t._v("\n          ("+t._s(e.row.operationDay)+"天)\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"batchNoStartDay",label:"计费周期"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.batchNoStartDay)+"至\n          "),a("br"),t._v("\n          "+t._s(e.row.batchNoEndDay)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"收费小计"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("¥"+t._s(t._f("ThousandNum")(e.row.subtotal)))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"代收代付小计"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("¥"+t._s(t._f("ThousandNum")(e.row.collFeeWithPayFee)))]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"btn-form-sub",attrs:{type:"text"},on:{click:function(a){t._toOperating(e.row)}}},[t._v("查看明细")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"sum"},[t._v("共"+t._s(t.total)+"条记录")]),t._v(" "),a("div",{staticClass:"pagination-content"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,40,80,100],"page-size":t.size,"page-count":t.totalPages,layout:" sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogFormVisible,"show-close":!1,center:!0,width:"500px",title:"费用导入","custom-class":"importFile"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",[a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"结算账期"}},[a("el-date-picker",{attrs:{type:"month",placeholder:"选择月份",format:"yyyy年MM月","value-format":"yyyyMM"},model:{value:t.batchNo,callback:function(e){t.batchNo=e},expression:"batchNo"}})],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"选择文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-error":t.uploadError,headers:t.headers,"on-success":t.handleExcelSuccess,"auto-upload":!0,action:t.action,data:t.formData,limit:t.limit,name:"files"}},[a("div",{staticClass:"viewFile"},[a("img",{attrs:{src:t.imagePath,alt:"浏览"}}),t._v(" "),a("p",{staticStyle:{padding:"0",margin:"0"}},[t._v("浏览")])])])],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"下载模板"}},[a("a",{staticStyle:{display:"inline-block",width:"98px",height:"32px","line-height":"32px",background:"rgba(0,96,114,0.1)","border-radius":"4px",color:"#006072","text-align":"center"},attrs:{href:t.tempHref,target:"_blank"}},[t._v("下载模板")])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-dialog-sub",on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{staticClass:"btn-dialog-primary",attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("提 交")])],1)],1)],1)},[],!1,null,"35afbcae",null);u.options.__file="settleAccountsList.vue";e.default=u.exports},aT9M:function(t,e,a){"use strict";var n=a("5OVc");a.n(n).a},d5K8:function(t,e,a){},t2Y8:function(t,e,a){"use strict";var n=a("QbLZ"),s=a.n(n),o=a("L2JU");function l(t,e){return e.includes(t)}e.a={computed:s()({},Object(o.b)(["name","btnPermissionRoles"])),created:function(){this._initBtnPermission()},methods:{_initBtnPermission:function(){var t=function(t,e){var a=[];if(t.length)return t.map(function(t){var n=t.split(":")[0],s=t.split(":")[1];n===e&&a.push(s)}),a}(this.btnPermissionRoles,this.PATH);this.btnArr=t,this.buttonFilter=l}}}}}]);