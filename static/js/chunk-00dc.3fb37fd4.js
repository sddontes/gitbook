(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-00dc"],{"5OVc":function(t,e,a){},"6aKk":function(t,e,a){"use strict";a.d(e,"p",function(){return s}),a.d(e,"r",function(){return i}),a.d(e,"q",function(){return l}),a.d(e,"o",function(){return o}),a.d(e,"n",function(){return c}),a.d(e,"v",function(){return r}),a.d(e,"a",function(){return u}),a.d(e,"k",function(){return d}),a.d(e,"h",function(){return h}),a.d(e,"l",function(){return p}),a.d(e,"m",function(){return m}),a.d(e,"b",function(){return f}),a.d(e,"d",function(){return b}),a.d(e,"c",function(){return g}),a.d(e,"e",function(){return _}),a.d(e,"j",function(){return y}),a.d(e,"g",function(){return v}),a.d(e,"f",function(){return C}),a.d(e,"s",function(){return S}),a.d(e,"i",function(){return x}),a.d(e,"t",function(){return N}),a.d(e,"u",function(){return w});var n=a("CcjM");function s(t){return Object(n.a)({url:"bzy-csg-settlement/settlementModel/pageList",method:"post",data:t})}function i(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/rule/pageList",method:"post",data:t})}function l(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/rule/detail/"+t,method:"get"})}function o(t){return Object(n.a)({url:"bzy-csg-settlement/bill/list",method:"post",data:t})}function c(t){return Object(n.a)({url:"bzy-csg-settlement/bill/queryBillDetail/"+t,method:"get"})}function r(t){return Object(n.a)({url:"bzy-csg-settlement/dataSync/serviceFeeExcel",method:"post",data:t})}function u(t){return Object(n.a)({url:"bzy-csg-settlement/settlementSubject/mini/achievement",method:"post",data:t})}function d(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/listByMultiselect",method:"post",data:t})}function h(t){return Object(n.a)({url:"bzy-csg-settlement/email/sendLog",method:"post",data:t})}function p(t){return Object(n.a)({url:"bzy-csg-settlement/paybill/pageList",method:"post",data:t})}function m(t){return Object(n.a)({url:"bzy-csg-settlement/email",method:"post",data:t})}function f(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/addBillInfoAdjust",method:"post",data:t})}function b(t){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf?"+t,method:"get"})}function g(t){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf",method:"post",data:t})}function _(t,e){return Object(n.a)({url:"bzy-csg-settlement/billExtendConf/"+t,data:e,method:"put",headers:{"Content-Type":"text/plain;charset=UTF-8"}})}function y(t){return Object(n.a)({url:"bzy-csg-settlement/dataSync/billExtend",method:"post",data:t})}function v(t){return Object(n.a)({url:"bzy-csg-settlement/billExtend/hierarchy",params:t,method:"get"})}function C(t){return Object(n.a)({url:"bzy-csg-settlement/billExtend/hotel",params:t,method:"get"})}function S(t){return Object(n.a)({url:"bzy-csg-settlement/settlementModel/list",data:t,method:"post"})}function x(t){return Object(n.a)({url:"bzy-csg-settlement/billInfoAdjust/importBillAdjustExcel",data:t,method:"post"})}function N(t){return Object(n.a)({url:"bzy-csg-settlement/transaction/payment",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}function w(t){return Object(n.a)({url:"bzy-csg-settlement/transaction/receipt",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}},MO4u:function(t,e,a){"use strict";var n={name:"FetchSuggestions",props:{hotelList:{type:Array,required:!0},searchTitle:{type:String,required:!0}},data:function(){return{code:"",searchCode:""}},methods:{blurSearch:function(){var t=this;if(this.code){var e=this.hotelList.find(function(e){return e.name===t.code||e.code===t.code});this.searchCode=e?e.code:this.code,this.$emit("getFetchCode",this.searchCode)}else this.$emit("getFetchCode",this.code)},handleSelect:function(t){this.searchCode=t.code,this.$emit("getFetchCode",this.searchCode)},querySearch:function(t,e){var a=this.hotelList;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return e.name.indexOf(t)>-1}}}},s=(a("aT9M"),a("KHd+")),i=Object(s.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-list-item"},[t.searchTitle?a("span",{staticStyle:{display:"inline-block",flex:"0 0 70px","margin-right":"10px","text-align":"right"}},[t._v(t._s(t.searchTitle))]):t._e(),t._v(" "),a("el-autocomplete",{staticStyle:{width:"168px",flex:"0 1 atuo"},attrs:{"fetch-suggestions":t.querySearch,clearable:"","value-key":"name",placeholder:"酒店名称/编号"},on:{select:t.handleSelect,blur:t.blurSearch,clear:t.blurSearch},nativeOn:{change:function(e){return t.blurSearch(e)}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1)},[],!1,null,"cff8e71e",null);i.options.__file="index.vue";e.a=i.exports},SwvG:function(t,e,a){},aE8o:function(t,e,a){"use strict";var n=a("SwvG");a.n(n).a},aT9M:function(t,e,a){"use strict";var n=a("5OVc");a.n(n).a},gbtx:function(t,e,a){"use strict";a.r(e);var n=a("6aKk"),s=a("Q2AE"),i=a("MO4u"),l=a("t2Y8"),o={name:"ShopAssignRecord",components:{FetchSuggestions:i.a},mixins:[l.a],data:function(){return{PATH:"settle-accounts/receipt-manage",loading:!1,newForm:{},hotelCodeOrName:"",hotelList:[],batchNo:"",code:"",statusList:[{label:"已审核",value:"ALREAY_AUDIT"},{label:"待财务审核",value:"WAIT_FINANCE_AUDIT"}],aceiptStatus:"",assigns:[],action:"",limit:1,currentPage:1,size:20,totalPages:1,total:0,multipleSelection:[]}},computed:{showChecksBtn:function(){return!!this.multipleSelection.length}},created:function(){var t=new Date,e=t.getMonth();t.getDate()>3?this.batchNo=t.getFullYear()+""+(e>9?e:"0"+e):this.batchNo=t.getFullYear()+""+(e-1>9?e-1:"0"+(e-1)),this._getpaybillList(),this._getRemoteData()},methods:{search:function(){this.currentPage=1;var t=new Date,e=t.getFullYear(),a=t.getDate(),n=t.getMonth()+1;n<11&&!this.batchNo||2019===e&&11===n&&a<4&&!this.batchNo||("2019"===this.batchNo.slice(0,4)&&this.batchNo.slice(4)<10?this.$message.error("抱歉，此账期数据不支持查询 "):this._getpaybillList())},getFetchCode:function(t){this.hotelCodeOrName=t},_pasuedTime:function(t){return"暂停时间： "+t.slice(0,10)},_getpaybillList:function(){var t=this,e=new Date,a=e.getFullYear(),s=e.getDate(),i=e.getMonth()+1;if((!(i<11)||this.batchNo)&&(!(2019===a&&11===i&&s<4)||this.batchNo)&&!("2019"===this.batchNo.slice(0,4)&&this.batchNo.slice(4)<10)){var l={hotelCodeOrName:this.hotelCodeOrName,batchNo:this.batchNo,status:this.aceiptStatus,page:this.currentPage,size:this.size};this.loading=!0,Object(n.l)(l).then(function(e){t.loading=!1,t.assigns=e.data.list,t.totalPages=e.data.pages,t.total=e.data.total})}},_sendCheckEmail:function(){var t=this,e=[];this.multipleSelection.forEach(function(t,a){e.push(t.payBillNo)}),e.length?this.$confirm("确定进行批量审核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={payBillNoList:e};t.loading=!0,Object(n.m)(a).then(function(e){t.loading=!1,"success"===e.message?t.$message({type:"success",message:e.data}):t.$message({type:"error",message:e.message}),t._getpaybillList()})}):this.$message.error("请选择需要审核的订单")},_exportExcel:function(){var t={hotelCodeOrName:this.hotelCodeOrName,batchNo:this.batchNo,status:this.aceiptStatus},e="";for(var a in t)e+=t[a]?"&"+a+"="+t[a]:"&"+a+"=";var n="http://bzy.hhotel.com/bzy-csg-settlement/file/payInfo/export?"+(e=e.substring(1));window.open(encodeURI(n),"_blank")},_getRemoteData:function(){var t=this;s.a.dispatch("getHotelList").then(function(e){t.hotelList=e})},_toOperating:function(t){var e=this,a=[];a.push(t.payBillNo);var s={payBillNoList:a};this.loading=!0,Object(n.m)(s).then(function(t){e.loading=!1;var a="success"===t.message?"success":"error";e.$message({type:a,message:t.message}),e._getpaybillList()})},handleSizeChange:function(t){this.size=t,this._getpaybillList()},handleCurrentChange:function(t){this.currentPage=t,this._getpaybillList()},handleSelectionChange:function(t){this.multipleSelection=t},isDisabled:function(t,e){return"已审核"!==this.assigns[e].auditStatusName}}},c=(a("aE8o"),a("KHd+")),r=Object(c.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hotel layout",attrs:{id:"receiptManage"}},[a("div",{staticClass:"tab-head"},[a("div",{staticClass:"tab-head-list"},[a("div",{staticClass:"el-row"},[a("div",{staticClass:"el-col el-col-22"},[a("div",{staticClass:"el-col"},[a("div",{staticClass:"tab-list-item"},[a("fetchSuggestions",{staticStyle:{width:"250px"},attrs:{"hotel-list":t.hotelList,"search-title":"结算方名称"},on:{getFetchCode:t.getFetchCode}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("所属账期")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"160px",float:"right","margin-left":"20px"},attrs:{type:"month",placeholder:"选择月份",format:"yyyy年MM月","value-format":"yyyyMM"},model:{value:t.batchNo,callback:function(e){t.batchNo=e},expression:"batchNo"}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("状态")]),t._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.aceiptStatus,callback:function(e){t.aceiptStatus=e},expression:"aceiptStatus"}},t._l(t.statusList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),a("span",{staticClass:"left_label"}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])])])])]),t._v(" "),a("div",{staticClass:"table-content"},[t.showChecksBtn?a("span",{staticClass:"float-right",attrs:{type:"primary"},on:{click:t._sendCheckEmail}},[t._v("批量审核")]):a("span",{staticClass:"float-right",staticStyle:{color:"#C0C4CC"},on:{click:t._sendCheckEmail}},[t._v("批量审核")]),t._v(" "),t.buttonFilter("settle-accounts",t.btnArr)?a("span",{staticClass:"float-right",on:{click:t._exportExcel}},[a("i",{staticClass:"iconfont iconic_download",staticStyle:{heigth:"16px",weigth:"16px"}}),t._v(" "),a("span",{attrs:{type:"primary"}},[t._v("导出")])]):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.assigns,"max-height":"500","empty-text":"暂无数据"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{selectable:t.isDisabled,type:"selection"}}),t._v(" "),a("el-table-column",{attrs:{prop:"payBillNo",label:"收款单编号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{float:"left",width:"130px"}},[a("p",[t._v(t._s(e.row.payBillNo))]),t._v(" "),a("router-link",{staticStyle:{color:"#228294","text-decoration":"underline"},attrs:{to:{path:"/settle-accounts/settle-accounts-costdetail",query:{billNo:e.row.billNo}}}},[t._v(t._s(e.row.billNo))])],1),t._v(" "),"PAUSED"===e.row.hotelStatus?a("el-tooltip",{staticClass:"item",staticStyle:{color:"red",padding:"13px 0px",display:"block",float:"right"},attrs:{content:t._pasuedTime(e.row.suspensionDate),effect:"dark",placement:"top-end"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{display:"block","font-size":"18px"}})]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"hotelName","min-width":"100px",label:"结算方名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.hotelName))]),t._v(" "),a("p",[t._v(t._s(e.row.hotelCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"signCompany","min-width":"100px",label:"签约主体"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batchNo",label:"所属账期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batchNoStartDay","min-width":"120px",label:"本期核算金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v("￥"+t._s(t._f("ThousandNum")(e.row.sumFee)))]),t._v(" "),a("p",[t._v("￥"+t._s(t._f("ThousandNum")(e.row.collFeeWithPayFee))+"|￥"+t._s(t._f("ThousandNum")(e.row.subtotal)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"payableManageFee",label:"往期调整金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(t._f("ThousandNum")(e.row.pastAdjustAmount)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"payableHotelManagerFee",label:"累计往期欠款"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(t._f("ThousandNum")(e.row.unpayWithPastAmount)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sumFeePay",label:"累计应付金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(t._f("ThousandNum")(e.row.sumFeePay)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"auditStatusName",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.auditStatusName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"btn-form-sub",attrs:{disabled:"已审核"===e.row.auditStatusName||"已确认"===e.row.statusName,type:"text"},on:{click:function(a){t._toOperating(e.row)}}},[t._v("审核")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"sum"},[t._v("共"+t._s(t.total)+"条记录")]),t._v(" "),a("div",{staticClass:"pagination-content"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,40,80,100],"page-size":t.size,"page-count":t.totalPages,layout:" sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])])},[],!1,null,"d8894886",null);r.options.__file="receiptManage.vue";e.default=r.exports},t2Y8:function(t,e,a){"use strict";var n=a("QbLZ"),s=a.n(n),i=a("L2JU");function l(t,e){return e.includes(t)}e.a={computed:s()({},Object(i.b)(["name","btnPermissionRoles"])),created:function(){this._initBtnPermission()},methods:{_initBtnPermission:function(){var t=function(t,e){var a=[];if(t.length)return t.map(function(t){var n=t.split(":")[0],s=t.split(":")[1];n===e&&a.push(s)}),a}(this.btnPermissionRoles,this.PATH);this.btnArr=t,this.buttonFilter=l}}}}}]);