(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a218"],{"/8lg":function(t,e,s){"use strict";s.d(e,"q",function(){return n}),s.d(e,"r",function(){return r}),s.d(e,"e",function(){return o}),s.d(e,"i",function(){return i}),s.d(e,"g",function(){return l}),s.d(e,"u",function(){return u}),s.d(e,"v",function(){return c}),s.d(e,"f",function(){return d}),s.d(e,"a",function(){return p}),s.d(e,"j",function(){return h}),s.d(e,"h",function(){return f}),s.d(e,"l",function(){return m}),s.d(e,"n",function(){return b}),s.d(e,"m",function(){return v}),s.d(e,"k",function(){return g}),s.d(e,"s",function(){return _}),s.d(e,"o",function(){return y}),s.d(e,"p",function(){return C}),s.d(e,"t",function(){return S}),s.d(e,"c",function(){return w}),s.d(e,"d",function(){return A}),s.d(e,"b",function(){return k});var a=s("CcjM");function n(t){return Object(a.a)({url:"bzy-upms/authUser/list",method:"get",params:t})}function r(t){return Object(a.a)({url:"bzy-upms/authUser/findUsersByRoleCode",method:"post",data:t})}function o(t){return Object(a.a)({url:"bzy-upms/authUser/getAllUser",method:"get",params:t})}function i(t){return Object(a.a)({url:"bzy-hotel/hotel/listEffective",method:"post",data:t})}function l(t){return Object(a.a)({url:"bzy-hotel/city/hotelAreaResourceList",method:"get",params:t})}function u(t){return Object(a.a)({url:"bzy-upms/user/hotelResource",method:"post",data:t})}function c(t){return Object(a.a)({url:"bzy-upms/user/hotelResource",method:"put",data:t})}function d(t){return Object(a.a)({url:"bzy-upms/user/hotelResource/getResourcesByUserForm",method:"post",data:t})}function p(t,e,s){var n="1"===t?"bzy-upms/user/hotelResource/"+e:"bzy-upms/user/hotelResource/"+e+"?allocationObject="+s;return Object(a.a)({url:n,method:"delete"})}function h(t){return Object(a.a)({url:"bzy-hotel/resource/getReleation/"+t,method:"get"})}function f(){return Object(a.a)({url:"bzy-upms/department/list",method:"get"})}function m(){return Object(a.a)({url:"bzy-upms/department/getSubDepartmentList",method:"get"})}function b(){return Object(a.a)({url:"bzy-upms/department/getSubUserRoleList",method:"get"})}function v(t){return Object(a.a)({url:"bzy-upms/user/hotelResource/querySubUserHotelResourceList",method:"post",data:t})}function g(){return Object(a.a)({url:"bzy-hotel/resource/getReleationHotelEffective",method:"get"})}function _(){return Object(a.a)({url:"bzy-hotel/city/hotelAreaPermissionResourceList",method:"get"})}function y(t){return Object(a.a)({url:"bzy-upms/theater/subList/"+t,method:"get"})}function C(t){return Object(a.a)({url:"bzy-upms/theater/getTheaterNodeDetails/"+t,method:"get",data:t})}function S(t){return Object(a.a)({url:"/bzy-upms/theater",method:"post",data:t})}function w(t){return Object(a.a)({url:"/bzy-upms/theater",method:"put",data:t})}function A(){return Object(a.a)({url:"bzy-upms/theater/queryAll",method:"get"})}function k(t){return Object(a.a)({url:"bzy-upms/theater/"+t,method:"delete"})}},MgXB:function(t,e,s){"use strict";var a=s("kKAr");s.n(a).a},"RU/L":function(t,e,s){s("Rqdy");var a=s("WEpk").Object;t.exports=function(t,e,s){return a.defineProperty(t,e,s)}},Rqdy:function(t,e,s){var a=s("Y7ZC");a(a.S+a.F*!s("jmDH"),"Object",{defineProperty:s("2faE").f})},SEkw:function(t,e,s){t.exports={default:s("RU/L"),__esModule:!0}},"X6+Z":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAALpJREFUKBVjYKAWyMzMVM/JydElZB4TFgVif/782ZOdnW2ORQ4uxAxnQRlnzpx5ZGpqevXfv38rzc3ND58+ffopuhoQH0MjSBCo+Q4hzVg1EqMZp0Z0zRYWFjtPnTr1CiQOAtgCByJDgGTEJw+MGs////8vAKrxnTFjxilktThthGliZmb2Q9cEMgCrjciapk6dehLZJhgbQyNQky3QeWtANuHSBNLMAjMBiX7FwsLiMmXKlMtIYtRjAgDXwGATOH9gyAAAAABJRU5ErkJggg=="},YEIV:function(t,e,s){"use strict";e.__esModule=!0;var a,n=s("SEkw"),r=(a=n)&&a.__esModule?a:{default:a};e.default=function(t,e,s){return e in t?(0,r.default)(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}},Z4ri:function(t,e,s){"use strict";s.r(e);var a=s("GQeE"),n=s.n(a),r=s("14Xm"),o=s.n(r),i=s("D3Ub"),l=s.n(i),u=s("gDS+"),c=s.n(u),d=s("lV9q"),p=s("YEIV"),h=s.n(p),f=s("jWXv"),m=s.n(f),b=s("rfXi"),v=s.n(b),g=s("/8lg"),_={name:"PatrolShopRecordIndex",mixins:[{data:function(){return{needAreaData:!0,props:{multiple:!0,value:"code",label:"name"},selList:[],areaCodeList:[]}},created:function(){this._getCityList()},methods:{selAreaFun:function(t){this.isUpdataArea=!0;var e=[];if(this.selList[0].children.map(function(t,s){t.children.map(function(t,s){e.push(s)})}),e.length!==t.length){var s=t,a=s.map(function(t){return t[1]}),n=[];v()(new m.a(a)).map(function(t){var e=[];s.map(function(s){t===s[1]&&e.push(s)}),n.push(h()({},""+t,e))});var r=[];this.selList[0].children.map(function(t){n.map(function(e){for(var s in e)s===t.code&&(e[s].length===t.children.length?r.push({resourceScope:1,resourceCode:s,resourceType:0}):e[s].map(function(t){r.push({resourceScope:2,resourceCode:t[2],resourceType:0})}))})}),this.resourceArr=r}else this.resourceArr=[{resourceScope:0,resourceCode:0,resourceType:0}]},_getCityList:function(){var t=this;Object(g.g)().then(function(e){t.selList=[e.data]})}}},s("t2Y8").a],data:function(){return{PATH:"patrol-shop-record/index",formInputWidth:"240px",users:[],selectTimes:null,isShopNameLoading:!1,userName:[],userStatus:"1",role:"RNMY0UD4338077588",patrolStatus:null,tableData:[],size:20,total:0,currentPage:1,dialogVisible:!1,dialogTotal:0,needAreaData:!1,totalElements:0,row:{}}},computed:{formatTime:function(){var t;return(t=this.selectTimes.map(function(t){return t.replace(/-/g,"/")}))[0]+" - "+t[1]}},mounted:function(){this._getUserList(),this._getPatrolShopList()},methods:{search:function(){this._getPatrolShopList()},selectUser:function(t){},handleSizeChange:function(t){this.size=t,this._getPatrolShopList()},handleCurrentChange:function(t){this.currentPage=t,this._getPatrolShopList()},dialogHandleCurrentChange:function(t){},hideDialogEvent:function(){this.dialogVisible=!1},showDialog:function(t){this.row=t,this.dialogVisible=!0},toDetails:function(t){var e=t.hotelCode;if(t.hotelSigninCount<=0)return this._myMessage({msg:"无签到信息！",type:"error"});var s={begEntryTime:this.selectTimes&&0!==this.selectTimes.length?this.selectTimes[0]:"",endEntryTime:this.selectTimes&&0!==this.selectTimes.length?this.selectTimes[1]:"",userId:this.row.userId,hotelCode:e},a=this.$router.resolve({name:"PatrolShopRecordDetails",query:{postData:c()(s),info:c()(this.row)}});window.open(a.href,"_blank")},collatingData:function(){var t=[],e=[];this.areaCodeList.forEach(function(s){s.forEach(function(s,a){1===a?t.push(s):2===a&&e.push(s)})});var s={cityCodeList:e,provinceCodeList:t,userIdList:this.userName,status:this.userStatus?this.userStatus:"",roleCode:this.role?this.role:"",inspectStatus:this.patrolStatus?this.patrolStatus:"",begEntryTime:this.selectTimes&&0!==this.selectTimes.length?this.selectTimes[0]:"",endEntryTime:this.selectTimes&&0!==this.selectTimes.length?this.selectTimes[1]:"",page:this.currentPage,size:this.size};return s},exportExcel:function(t){var e=this;return l()(o.a.mark(function t(){var s,a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.collatingData();case 2:for(n in s=t.sent,a="",s)a+="&"+n+"="+s[n];a=a.substring(1),a+="&userId="+e.$store.state.user.userId,r="http://bzy.hhotel.com/bzy-sk/tour/exportUserGroupList?"+a,r=encodeURI(r),window.open(r,"_blank");case 10:case"end":return t.stop()}},t,e)}))()},_getUserList:function(){var t=this;this.isShopNameLoading=!0;Object(g.e)({}).then(function(e){t.users=e.data.map(function(t){return{id:t.id,name:t.name}}),t.isShopNameLoading=!1})},_getPatrolShopList:function(){var t=this;return l()(o.a.mark(function e(){var s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collatingData();case 2:s=e.sent,Object(d.b)(s).then(function(e){e.data.list.forEach(function(t){n()(t).forEach(function(e){t[e]||0===t[e]||(t[e]="",t[e]="hotelGroupSingCountVos"===e?[]:"")})}),t.tableData=e.data.list,t.total=e.data.total});case 4:case"end":return e.stop()}},e,t)}))()}}},y=(s("MgXB"),s("KHd+")),C=Object(y.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hotel layout publicDialog",attrs:{id:"patrolShopRecord"}},[a("div",{staticClass:"tab-head"},[a("div",{staticClass:"tab-head-list"},[a("div",{staticClass:"el-row"},[a("div",{staticClass:"el-col el-col-22"},[a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("日期")]),t._v(" "),a("el-date-picker",{style:{width:t.formInputWidth},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:t.selectTimes,callback:function(e){t.selectTimes=e},expression:"selectTimes"}})],1)]),t._v(" "),a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("区域")]),t._v(" "),a("el-cascader",{style:{width:t.formInputWidth},attrs:{options:t.selList,props:t.props,placeholder:"请选择省份",filterable:"","collapse-tags":"",clearable:""},on:{change:t.selAreaFun},model:{value:t.areaCodeList,callback:function(e){t.areaCodeList=e},expression:"areaCodeList"}})],1)]),t._v(" "),a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("姓名")]),t._v(" "),a("el-select",{style:{width:t.formInputWidth},attrs:{loading:t.isShopNameLoading,filterable:"",multiple:"","collapse-tags":"",clearable:"",placeholder:"请选择"},on:{change:t.selectUser},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}},t._l(t.users,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("账号状态")]),t._v(" "),a("el-select",{style:{width:t.formInputWidth},attrs:{placeholder:"请选择"},model:{value:t.userStatus,callback:function(e){t.userStatus=e},expression:"userStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{key:"1",attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{key:"0",attrs:{label:"禁用",value:"0"}})],1)],1)]),t._v(" "),a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("角色")]),t._v(" "),a("el-select",{style:{width:t.formInputWidth},attrs:{placeholder:"请选择"},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{key:"RNMY0UD4338077588",attrs:{label:"运营经理",value:"RNMY0UD4338077588"}})],1)],1)]),t._v(" "),a("div",{staticClass:"el-col el-col-8"},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("巡店情况")]),t._v(" "),a("el-select",{style:{width:t.formInputWidth},attrs:{placeholder:"请选择"},model:{value:t.patrolStatus,callback:function(e){t.patrolStatus=e},expression:"patrolStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),t._v(" "),a("el-option",{key:"0",attrs:{label:"未巡店",value:"0"}}),t._v(" "),a("el-option",{key:"1",attrs:{label:"已巡店",value:"1"}})],1)],1)])]),t._v(" "),a("div",{staticClass:"el-col el-col-2"},[a("div",{staticClass:"tab-list-item",staticStyle:{direction:"rtl"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])])])]),t._v(" "),t.buttonFilter("lead-out",t.btnArr)?a("div",{staticStyle:{float:"right"}},[a("div",{staticClass:"btn-right"},[t.buttonFilter("lead-out",t.btnArr)?a("span",{attrs:{type:"primary"}},[a("i",{staticClass:"iconfont iconic_download",on:{click:t.exportExcel}}),t._v(" "),a("span",{staticClass:"add",on:{click:t.exportExcel}},[t._v("导出")])]):t._e()])]):t._e(),t._v(" "),a("div",{staticClass:"table-content"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"max-height":"500","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"jobNumber",label:"员工工号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"roleNameList",label:"角色"}}),t._v(" "),a("el-table-column",{attrs:{prop:"provinceName",label:"区域"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.provinceName+" "+e.row.cityName))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"isInspectName",label:"巡店情况"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:{color:"未巡查"===e.row.isInspectName?"#FF4E36":""}},[t._v(t._s(e.row.isInspectName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"signinCount",label:"签到次数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"hotelSinginCount",label:"签到酒店"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"btn-form-sub",attrs:{size:"mini"},on:{click:function(s){t.showDialog(e.row)}}},[t._v("查看详情")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"sum"},[t._v("共计"+t._s(t.total)+"条")]),t._v(" "),a("div",{staticClass:"pagination-content"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,40,80,100],"page-size":t.size,total:t.total,layout:" sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"40.6%",title:"巡店详情"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialogHeader"},[a("span",{staticClass:"info"},[t._v(t._s(t.row.name)+" "+t._s(t.row.jobNumber))]),t._v(" "),null!==t.selectTimes?a("span",{staticClass:"dataTime"},[t._v(t._s(t.formatTime))]):t._e()]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.row.hotelGroupSingCountVos,"max-height":"350","empty-text":"暂无数据"},on:{"row-click":t.toDetails}},[a("el-table-column",{attrs:{prop:"hotelName",label:"酒店"}}),t._v(" "),a("el-table-column",{attrs:{prop:"allotName",label:"分配关系",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{style:{color:"未分配"===e.row.allotName?"#FF4E36":""}},[t._v(t._s(e.row.allotName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"hotelSigninCount","header-align":"center",align:"center",label:"签到次数",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("u",{staticClass:"hotelSigninCount",on:{click:function(s){t.toDetails(e.row.hotelCode,e.row.hotelSigninCount)}}},[t._v(t._s(e.row.hotelSigninCount))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"icon_wrap",attrs:{data:{scope:t}}},[a("img",{attrs:{src:s("X6+Z"),alt:""}})])]}}])})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"el-button btn-default",on:{click:t.hideDialogEvent}},[t._v("取消")])],1)],1)],1)},[],!1,null,"1269d9c9",null);C.options.__file="index.vue";e.default=C.exports},"gDS+":function(t,e,s){t.exports={default:s("oh+g"),__esModule:!0}},kKAr:function(t,e,s){},lV9q:function(t,e,s){"use strict";s.d(e,"b",function(){return n}),s.d(e,"a",function(){return r});var a=s("CcjM");function n(t){return Object(a.a)({url:"bzy-sk/tour/getUserGroupList",method:"post",data:t})}function r(t){return Object(a.a)({url:"bzy-sk/tour/getSingnHotelInfoList",method:"post",data:t})}},"oh+g":function(t,e,s){var a=s("WEpk"),n=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},t2Y8:function(t,e,s){"use strict";var a=s("QbLZ"),n=s.n(a),r=s("L2JU");function o(t,e){return e.includes(t)}e.a={computed:n()({},Object(r.b)(["name","btnPermissionRoles"])),created:function(){this._initBtnPermission()},methods:{_initBtnPermission:function(){var t=function(t,e){var s=[];if(t.length)return t.map(function(t){var a=t.split(":")[0],n=t.split(":")[1];a===e&&s.push(n)}),s}(this.btnPermissionRoles,this.PATH);this.btnArr=t,this.buttonFilter=o}}}}}]);