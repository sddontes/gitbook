(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0a91"],{"3M8W":function(t,e,a){"use strict";var i=a("r2UZ");a.n(i).a},dCpZ:function(t,e,a){"use strict";a.r(e);var i=a("tyD3"),s=a("+c+A"),o=a("MO4u"),n=a("/8lg"),l=a("Ch/I"),r=a("ZrcN"),c=a("pfto"),h=a("MT78"),v={name:"Dashboard",components:{FetchSuggestions:o.a},mixins:[i.a,s.a],data:function(){var t=this;return{samPeriod:"",pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},formInputWidth:"168px",imagePath:a("pq5O"),upIcon:a("3N+R"),downIcon:a("VIdv"),isShowTip2:!1,tipData2:{},isLoading:!0,myTop:"210px",myRight:"200px",myLeft:"",myChart:null,radioVal:!1,activeName:"GMV",titleName:"店均GMV",tipData:[],hotelList:[],status:["OPERATIONING"],hotelStates:l.c,cityValue:"",selForm:{startDate:"",endDate:"",theaterNodeIds:"",provinceCode:"",cityCode:"",areaCode:"",hotelCode:"",status:["OPERATIONING"],samePeriodRation:!1},warZone:[],choiceDate:"",option:{color:["#79BFCC"],title:{text:"店均GMV趋势图",x:"center"},legend:{selectedMode:!1,orient:"vertical",top:0,right:40,bottom:20,data:["查询时段","去年同期"]},grid:{left:"3%",right:"4%",bottom:"3%",top:"8%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[],axisLabel:{interval:"auto",rotate:-90}},yAxis:{type:"value",splitLine:{show:!1},axisLabel:{formatter:function(e,a){return"OCC"===t.activeName&&(e+="%"),e}}},series:[{name:"查询时段",type:"line",itemStyle:{normal:{color:"#f5924a",lineStyle:{color:"#f5924a"}}},data:[]}]},isShowTip:!1,subTotal:{},isOk:!0,totalElements:[],getTipData:[],isSearch:!0}},mounted:function(){var t=this;Object(n.i)({}).then(function(e){t.hotelList=e.data.hotelList}),Object(c.b)(31,2).then(function(e){if(t.choiceDate=e,t.$route.query.type)switch(t.$route.query.type){case"gmv":t.activeName="GMV",t.titleName="店均GMV";break;case"occ":t.activeName="OCC",t.titleName="OCC";break;case"adr":t.activeName="ADR",t.titleName="ADR";break;case"revpar":t.activeName="RevPAR",t.titleName="RevPAR";break;default:t.activeName="间夜量",t.titleName="店均间夜量"}t.search()})},methods:{getFetchCode:function(t){this.selForm.hotelCode=t},selectCity:function(){this.selForm.provinceCode=this.cityValue[0],this.selForm.cityCode=this.cityValue[1],this.selForm.areaCode=this.cityValue[2]},filterSelect:function(t){this[t].includes(0)&&(this[t]=[0])},selectTip:function(t){},hasBottomClass:function(t,e){if(t.length>3&&1===e)return"add-margin-bottom"},getLine:function(){var t=this;this.selForm.samePeriodRation&&this.option.series.splice(1,1),this.samPeriod="";var e={areaCode:this.selForm.areaCode,cityCode:this.selForm.cityCode,provinceCode:this.selForm.provinceCode,hotelCode:this.selForm.hotelCode,samePeriodRation:this.selForm.samePeriodRation,startDate:this.choiceDate[0],endDate:this.choiceDate[1],status:this.status,theaterNodeIds:this.warZone};Object(r.e)(e).then(function(e){t.isOk=!0,t.subTotal=e.data.subTotal,t.totalElements=e.data.totalElements;var a=e.data.totalElements,i=[],s=[],o=[],n=[],l=[],r=[],c=[];t.getTipData=[];var h=[],v=[],p=[],d=[],m=[];a.map(function(e){i.push(e.bizDate),o.push(e.averageGmv||0),n.push(parseFloat(e.occ)||0),l.push(e.revrpar||0),r.push(e.averageRoomNightNum||0),c.push(e.adr||0),t.selForm.samePeriodRation&&(h.push(e.averageSamePeriodGmv||0),v.push(parseFloat(e.samePeriodOcc)||0),p.push(e.samePeriodrevpar||0),d.push(e.averageSamePeriodRoomNightNum||0),m.push(e.samePeriodAdr||0)),t.getTipData.push({gmv:e.previousMonthGmvIncreaseRation,occ:e.previousMonthOccIncreaseRation,revrpar:e.previousMonthrevparIncreaseRation,roomNightNum:e.previousMonthRoomNightNumIncreaseRation,adr:e.previousMonthAdrIncreaseRation,gmvSame:e.samePeriodGmvIncreaseRation,occSame:e.samePeriodOccIncreaseRation,revrparSame:e.samePeriodrevparIncreaseRation,roomNightNumSame:e.samePeriodRoomNightNumIncreaseRation,adrSame:e.samePeriodAdrIncreaseRation})}),t.option.xAxis.data=i,"GMV"===t.activeName&&(t.option.series[0].data=o,s=h,t.samPeriod=t.subTotal.samPeriodGmvRationIncreation),"OCC"===t.activeName&&(t.option.series[0].data=n,s=v,t.samPeriod=t.subTotal.samPeriodOccRationIncreation),"RevPAR"===t.activeName&&(t.option.series[0].data=l,s=p,t.samPeriod=t.subTotal.samPeriodRevparRationIncreation),"间夜量"===t.activeName&&(t.option.series[0].data=r,s=d,t.samPeriod=t.subTotal.samPeriodRoomNightNumRationIncreation),"ADR"===t.activeName&&(t.option.series[0].data=c,s=m,t.samPeriod=t.subTotal.samPeriodAdrRationIncreation),t.selForm.samePeriodRation?(t.option.series.push({name:"去年同期",type:"line",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"#DDF3F7"},{offset:1,color:"#FAFBFB"}],global:!1}},smooth:!1,lineStyle:{color:"#79bfcc",type:"dashed"},data:[]}),t.option.series[1].data=s,t.option.title.text=t.titleName+"对比趋势图",t.option.title.subtext="(仅统计数据完整酒店)"):(t.option.series.splice(1,1),t.option.title.text=t.titleName+"趋势图",t.option.title.subtext=""),t.isLoading=!1,0===t.totalElements.length?t.myChart&&t.myChart.clear():t.initLinear()})},getRadioFun:function(t){t?(this.selForm.samePeriodRation=!0,this.search()):(this.selForm.samePeriodRation=!1,this.isShowTip=!1,this.isShowTip2=!1,this.search())},handleClick:function(){"GMV"===this.activeName||"间夜量"===this.activeName?this.titleName="店均"+this.activeName:this.titleName=this.activeName,this.option.title.text=this.titleName+"趋势图",this.isOk&&(this.isOk=!1,this.search())},initLinear:function(){var t=this;this.myChart=h.init(document.getElementById("main")),this.myChart.setOption(this.option,!0),this.myChart.on("click",function(e){t.isShowTip=!1,t.isShowTip2=!1;var a=e.dataIndex,i=t.option;if("查询时段"===e.seriesName){var s="",o="";t.isShowTip=!0;var n=void 0;switch(t.activeName){case"GMV":s=t.getTipData[a].gmv,o=t.getTipData[a].gmvSame,n=0!==parseFloat(e.value)?"¥"+(Number(e.value).toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,"):0;break;case"OCC":n=0!==parseFloat(e.value)?e.value+"%":0,s=t.getTipData[a].occ,o=t.getTipData[a].occSame;break;case"RevPAR":n=0!==parseFloat(e.value)?"¥"+(Number(e.value).toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,"):0,s=t.getTipData[a].revrpar,o=t.getTipData[a].revrparSame;break;case"间夜量":n=e.value,s=t.getTipData[a].roomNightNum,o=t.getTipData[a].roomNightNumSame;break;case"ADR":n=0!==parseFloat(e.value)?"¥"+(Number(e.value).toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,"):0,s=t.getTipData[a].adr,o=t.getTipData[a].adrSame}i.series[1]?t.tipData={type:t.titleName,value:n,date:i.xAxis.data[a],data:[{name:"年同比增长率",lv:o,_type:"year"},{name:"月环比增长率",lv:s,_type:"month"}]}:t.tipData={type:t.titleName,value:n,date:i.xAxis.data[a],data:[{name:"月环比增长率",lv:s,_type:"month"}]}}else switch(t.isShowTip2=!0,t.tipData2.date=i.xAxis.data[a],t.tipData2.type="去年同期"+t.activeName,t.activeName){case"OCC":t.tipData2.value=0!==parseFloat(e.value)?e.value+"%":0;break;case"间夜量":t.tipData2.value=e.value;break;default:t.tipData2.value=0!==parseFloat(e.value)?"¥"+(Number(e.value).toFixed(2)+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,"):0}if(e.event.event.clientX+400>window.innerWidth){t.myLeft="",t.myRight="10px";var l=Math.round((window.innerWidth-e.event.event.clientX)/30);t.myRight=10+10*l+"px"}else t.myLeft=e.event.offsetX+20+"px";window.innerHeight-e.event.event.clientY<=300?t.myTop=e.event.offsetY-120+"px":t.myTop=e.event.offsetY+70+"px"})},search:function(){(this.isShowTip=!1,this.isShowTip2=!1,this.choiceDate)?new Date(this.choiceDate[1]).getTime()-new Date(this.choiceDate[0]).getTime()>7776e6?this.$message.error("日期范围不能超过3个月"):(this.isLoading=!0,this.getLine()):this.$message.error("请选择时间")}}},p=(a("3M8W"),a("KHd+")),d=Object(p.a)(v,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-container",staticStyle:{"margin-top":"0"},attrs:{id:"dashboard"}},[a("div",{staticClass:"tab-head",staticStyle:{margin:"0",padding:"0"}},[a("div",{staticClass:"tab-head-list"},[a("el-row",[a("el-col",{attrs:{span:22}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item",attrs:{id:"multiple_sty"}},[a("span",{staticClass:"left_label"},[t._v("战区")]),t._v(" "),a("el-cascader",{staticStyle:{width:"168px"},attrs:{options:t.thaeterList,props:t.propsThaeter,"collapse-tags":"",clearable:"",filterable:""},on:{change:t.getThaeter}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("区域")]),t._v(" "),a("el-cascader",{style:{width:t.formInputWidth},attrs:{options:t.city,props:t.props,filterable:"",clearable:"",placeholder:"请选择"},on:{change:t.selectCity},model:{value:t.cityValue,callback:function(e){t.cityValue=e},expression:"cityValue"}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("fetchSuggestions",{attrs:{"hotel-list":t.hotelList,"search-title":"酒店"},on:{getFetchCode:t.getFetchCode}})],1)])],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"tab-list-item"},[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:22}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("酒店状态")]),t._v(" "),a("el-select",{style:{width:t.formInputWidth},attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:function(e){t.filterSelect("status")}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.hotelStates,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("日期")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"248px",flex:"0 0 248px"},attrs:{"picker-options":t.pickerOptions,"start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",type:"daterange",align:"right"},model:{value:t.choiceDate,callback:function(e){t.choiceDate=e},expression:"choiceDate"}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}})],1),t._v(" "),a("el-col",{attrs:{span:2}})],1)],1),t._v(" "),a("div",{staticClass:"wrap"},[a("el-checkbox",{staticClass:"right_radio",on:{change:t.getRadioFun},model:{value:t.radioVal,callback:function(e){t.radioVal=e},expression:"radioVal"}},[t._v("查看同比")]),t._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"GMV",name:"GMV"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"OCC",name:"OCC"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"ADR",name:"ADR"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"间夜量",name:"间夜量"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"RevPAR",name:"RevPAR"}})],1)],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticStyle:{position:"relative",height:"600px"}},[a("div",{staticStyle:{height:"580px",border:"1px solid #DCDFE6","margin-top":"-16px","border-top":"0","padding-top":"34px"},attrs:{id:"main"}}),t._v(" "),a("img",{directives:[{name:"show",rawName:"v-show",value:t.totalElements&&0===t.totalElements.length,expression:" totalElements && totalElements.length===0"}],staticClass:"none_sty",staticStyle:{width:"510px",height:"300px"},attrs:{src:t.imagePath}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTip,expression:"isShowTip"}],staticClass:"tip",staticStyle:{position:"absolute"},style:[{top:t.myTop,left:t.myLeft,right:t.myRight}]},[a("div",{staticClass:"content"},[a("div",[a("div",{staticClass:"content-item"},[t._v(t._s(t.tipData.date))]),t._v(" "),a("div",{staticClass:"content-item"},[t._v("\n            "+t._s(t.tipData.type)+"\n            "+t._s(t.tipData.value)+"\n          ")])]),t._v(" "),t._l(t.tipData.data,function(e,i){return a("div",{key:e.name,staticClass:"content-item",class:t.hasBottomClass(t.tipData,i),style:{color:e.lv&&parseFloat(e.lv)<0?"#ec1666":""},on:{click:function(a){t.selectTip(e._type)}}},[t._v("\n          "+t._s(e.name)+"\n          "),e.lv?a("span",[t._v(t._s(0===parseFloat(e.lv)?0:e.lv))]):t._e(),t._v(" "),e.lv?t._e():a("span",[t._v(t._s(0))]),t._v(" "),e.lv&&0!==parseFloat(e.lv)?a("img",{staticStyle:{width:"12px",height:"12px"},attrs:{src:parseFloat(e.lv)>0?t.upIcon:t.downIcon}}):t._e()])})],2),t._v(" "),a("div",{staticClass:"closeIcon",on:{click:function(e){t.isShowTip=!1}}},[a("i",{staticClass:"el-icon-close"})])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowTip2,expression:"isShowTip2"}],staticClass:"tip",staticStyle:{position:"absolute"},style:[{top:t.myTop,left:t.myLeft,right:t.myRight,background:"#79bfcc"}]},[a("div",{staticClass:"content"},[a("div",[a("div",{staticClass:"content-item"},[t._v(t._s(t.tipData2.date))]),t._v(" "),a("div",{staticClass:"content-item"},[t._v("\n            "+t._s(t.tipData2.type)+"\n            "+t._s(t.tipData2.value)+"\n          ")])])]),t._v(" "),a("div",{staticClass:"closeIcon",on:{click:function(e){t.isShowTip2=!1}}},[a("i",{staticClass:"el-icon-close"})])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.totalElements&&0!==t.totalElements.length,expression:"totalElements && totalElements.length!==0"}],staticStyle:{color:"#666666","line-height":"22px"}},[a("span",{staticClass:"mr28"},[t._v("\n      小计：\n      共\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.totalHotel||0))]),t._v("\n      家有数据酒店（分布于\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.totalCity||0))]),t._v("\n      个城市）\n    ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"OCC"===t.activeName,expression:"activeName==='OCC'"}]},[t._v("\n      "+t._s(t.activeName)+"：\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.averageOcc||0))])]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"ADR"===t.activeName,expression:"activeName==='ADR'"}]},[t._v("\n      "+t._s(t.activeName)+"：\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.averageAdr||0))])]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"RevPAR"===t.activeName,expression:"activeName==='RevPAR'"}]},[t._v("\n      "+t._s(t.activeName)+"：\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.averageRevpar||0))])]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"GMV"===t.activeName,expression:"activeName==='GMV'"}]},[t._v("\n      "+t._s(t.activeName)+"总值：\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.totalGmv||0))]),t._v("\n      （单店日均\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.averageGmvStr||0))]),t._v("）\n    ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"间夜量"===t.activeName,expression:"activeName==='间夜量'"}]},[t._v("\n      总"+t._s(t.activeName)+"：\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.totalRoomNightNum||0))]),t._v("\n      （单店日均\n      "),a("span",{staticClass:"sty_col"},[t._v(t._s(t.subTotal.averageRoomNightNumStr||0))]),t._v("\n      ）\n    ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.radioVal&&t.samPeriod,expression:"radioVal && samPeriod"}],staticClass:"sty_bg",style:{background:parseFloat(t.samPeriod)<=0?"#FF4E36":""}},[parseFloat(t.samPeriod)<=0?a("i",{staticClass:"iconfont iconxiaojixiajiang"}):t._e(),t._v(" "),parseFloat(t.samPeriod)>0?a("i",{staticClass:"iconfont iconxiaojishangsheng"}):t._e(),t._v("\n      "+t._s(t.samPeriod||0)+"\n    ")])])])},[],!1,null,"cdfc0f96",null);d.options.__file="lineIndex.vue";e.default=d.exports},mDvr:function(t,e,a){"use strict";a.d(e,"b",function(){return s}),a.d(e,"a",function(){return o});var i=a("CcjM");function s(t){return Object(i.a)({url:"bzy-collection/originBuget/query",method:"post",data:t})}function o(t){return Object(i.a)({url:"bzy-hotel/hotel/list",method:"get",params:t})}},r2UZ:function(t,e,a){},tg1W:function(t,e,a){"use strict";a.d(e,"a",function(){return l}),a.d(e,"b",function(){return r});var i=a("jWXv"),s=a.n(i),o=a("rfXi"),n=a.n(o);function l(t){if(null===t||t){var e={};for(var a in t)void 0!==t[a]&&""!==t[a]&&null!==t[a]&&0!==t[a]&&(e[a]=t[a]);return e}}function r(t){var e="",a=t.map(function(t){return e=-1!==t.indexOf("proprietor")?"proprietor":-1!==t.indexOf("finance")?"finance":-1!==t.indexOf("all")?"all":""}),i=n()(new s.a(a));return e="",i.includes("finance")&&i.includes("proprietor")?e="admin":i.map(function(t){-1!==t.indexOf("finance")?e="finance":-1!==t.indexOf("proprietor")?e="proprietor":-1===t.indexOf("all")||e||(e="all")}),e}},tyD3:function(t,e,a){"use strict";var i=a("/uL/"),s=a("mDvr"),o=a("VLRh"),n=a("tg1W");e.a={data:function(){return{code:null,size:20,currentPage:1,totalPages:1,hotelName:"",city:[],hotels:[],cityValue:[],totalElements:0,props:{value:"code",label:"name",checkStrictly:!0},hotelStates:[{value:0,label:"全部"},{value:o.r,label:"待运营"},{value:o.k,label:"运营中"},{value:o.l,label:"已暂停"},{value:o.q,label:"已解约"}]}},computed:{loading:function(){return this.$store.getters.loading}},created:function(){this._getCity(),"HotelManageIndex"===!this.$options.name&&this._getHotel()},methods:{handleSizeChange:function(t){this.size=t,this._getHotel()},handleCurrentChange:function(t){this.currentPage=t,this._getHotel("pageChange")},search:function(){this.currentPage=1,this._getHotel()},selectCity:function(t){this.provinceCode=t[0]||"",this.proviceCode=t[0]||"",this.cityCode=t[1]||"",this.areaCode=t[2]||""},_getCity:function(){var t=this;Object(i.g)().then(function(e){t.city=e.data})},_getHotel:function(t){var e=this;this.hotels=[];var a={hotelName:this.hotelName,page:"pageChange"===t?this.currentPage:1,size:this.size,status:0!==this.status?this.status:"",cooperationMode:0!==this.modeVal?this.modeVal:"",startSignDate:this.hotelDate&&0!==this.hotelDate.length?this.hotelDate[0]:"",endSignDate:this.hotelDate&&0!==this.hotelDate.length?this.hotelDate[1]:"",proviceCode:this.provinceCode,cityCode:this.cityCode,areaCode:this.areaCode,code:this.code,hotelAdminStatus:this.hotelAdminStatus};a=Object(n.a)(a),Object(s.a)(a).then(function(t){e.hotels=t.data.list,e.total=parseInt(t.data.totalElements),e.totalGMV=t.data.totalGMV,e.totalSRN=t.data.totalSRN,e.totalPages=t.data.totalPages,e.totalElements=t.data.totalElements})}}}}}]);