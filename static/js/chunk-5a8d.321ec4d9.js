(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5a8d"],{"/8lg":function(e,t,r){"use strict";r.d(t,"q",function(){return i}),r.d(t,"r",function(){return o}),r.d(t,"e",function(){return a}),r.d(t,"i",function(){return s}),r.d(t,"g",function(){return l}),r.d(t,"u",function(){return c}),r.d(t,"v",function(){return u}),r.d(t,"f",function(){return d}),r.d(t,"a",function(){return h}),r.d(t,"j",function(){return f}),r.d(t,"h",function(){return m}),r.d(t,"l",function(){return b}),r.d(t,"n",function(){return p}),r.d(t,"m",function(){return g}),r.d(t,"k",function(){return v}),r.d(t,"s",function(){return y}),r.d(t,"o",function(){return C}),r.d(t,"p",function(){return w}),r.d(t,"t",function(){return L}),r.d(t,"c",function(){return j}),r.d(t,"d",function(){return O}),r.d(t,"b",function(){return _});var n=r("CcjM");function i(e){return Object(n.a)({url:"bzy-upms/authUser/list",method:"get",params:e})}function o(e){return Object(n.a)({url:"bzy-upms/authUser/findUsersByRoleCode",method:"post",data:e})}function a(e){return Object(n.a)({url:"bzy-upms/authUser/getAllUser",method:"get",params:e})}function s(e){return Object(n.a)({url:"bzy-hotel/hotel/listEffective",method:"post",data:e})}function l(e){return Object(n.a)({url:"bzy-hotel/city/hotelAreaResourceList",method:"get",params:e})}function c(e){return Object(n.a)({url:"bzy-upms/user/hotelResource",method:"post",data:e})}function u(e){return Object(n.a)({url:"bzy-upms/user/hotelResource",method:"put",data:e})}function d(e){return Object(n.a)({url:"bzy-upms/user/hotelResource/getResourcesByUserForm",method:"post",data:e})}function h(e,t,r){var i="1"===e?"bzy-upms/user/hotelResource/"+t:"bzy-upms/user/hotelResource/"+t+"?allocationObject="+r;return Object(n.a)({url:i,method:"delete"})}function f(e){return Object(n.a)({url:"bzy-hotel/resource/getReleation/"+e,method:"get"})}function m(){return Object(n.a)({url:"bzy-upms/department/list",method:"get"})}function b(){return Object(n.a)({url:"bzy-upms/department/getSubDepartmentList",method:"get"})}function p(){return Object(n.a)({url:"bzy-upms/department/getSubUserRoleList",method:"get"})}function g(e){return Object(n.a)({url:"bzy-upms/user/hotelResource/querySubUserHotelResourceList",method:"post",data:e})}function v(){return Object(n.a)({url:"bzy-hotel/resource/getReleationHotelEffective",method:"get"})}function y(){return Object(n.a)({url:"bzy-hotel/city/hotelAreaPermissionResourceList",method:"get"})}function C(e){return Object(n.a)({url:"bzy-upms/theater/subList/"+e,method:"get"})}function w(e){return Object(n.a)({url:"bzy-upms/theater/getTheaterNodeDetails/"+e,method:"get",data:e})}function L(e){return Object(n.a)({url:"/bzy-upms/theater",method:"post",data:e})}function j(e){return Object(n.a)({url:"/bzy-upms/theater",method:"put",data:e})}function O(){return Object(n.a)({url:"bzy-upms/theater/queryAll",method:"get"})}function _(e){return Object(n.a)({url:"bzy-upms/theater/"+e,method:"delete"})}},"32LA":function(e,t,r){"use strict";function n(e){return e.map(function(e){var t=[];return e.children.map(function(e){t.push({name:e.name,code:e.code})}),{name:e.name,code:e.code,children:t}})}function i(e){return e.map(function(e){var t=[];return e.children.map(function(e){t.push({nodeName:e.nodeName,id:e.id})}),{nodeName:e.nodeName,id:e.id,children:t}})}r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i})},"9af2":function(e,t,r){},Aelc:function(e,t,r){"use strict";r("EJiy");var n=r("rfXi"),i=r.n(n),o=r("jWXv"),a=r.n(o),s=r("/8lg"),l=r("32LA");t.a={data:function(){return{selList:[],isAll:!1,needAreaData:!0,props:{value:"code",label:"name",checkStrictly:!0},areaCodeList:[],proviceCode:[],cityCode:[],areaCode:[]}},created:function(){this._getCityList()},methods:{selAreaFun:function(e){var t=new a.a,r=new a.a,n=new a.a;e.forEach(function(e){t.add(e[0]),r.add(e[1]),e.length>2&&n.add(e[2])}),this.proviceCode=i()(t),this.cityCode=i()(r),this.areaCode=i()(n)},repetitionFilter:function(e,t){var r=this;return this.proviceCode.forEach(function(n){var i=0;r.selList.forEach(function(e){e.code===n&&(i=e.children.length)});var o=0;r.cityCode.forEach(function(e){e.startsWith(n)&&(o+=1)}),i===o?t=t.filter(function(e){return!e.startsWith(n)}):e=e.filter(function(e){return e!==n})}),{proviceCode:e,cityCode:t}},_getCityList:function(){var e=this;Object(s.g)().then(function(t){var r=e.needAreaData?[t.data]:[Object(l.b)(t.data)];e.selList=e.isAll?r:r[0].children})}}}},"Lcc+":function(e,t,r){"use strict";var n=r("9af2");r.n(n).a},zF2I:function(e,t,r){"use strict";r.r(t);var n=r("14Xm"),i=r.n(n),o=r("D3Ub"),a=r.n(o),s=r("/8lg"),l={mixins:[r("Aelc").a],data:function(){var e=this;return{visible:!1,popoverShow:[!1],data:[],defaultProps:{label:"nodeName",children:"children"},userList:[],tableData:[],theaterNodeIds:1,filterText:"",dialogFormVisible:!1,imagePath:"",formLabelWidth:"120px",formInputWidth:"80%",dialogTitle:"编辑组织",loadingFlag:!1,newFormRules:{nodeName:[{required:!0,message:"请输入部门名称",trigger:"blur"}],areaCodeList:[{required:!0,validator:function(t,r,n){if(0===e.areaCodeList.length)return n(new Error("请选择省/市"));n()},trigger:"change"}],masterId:[{required:!0,message:"请选择负责人",trigger:"change"}]},rightTitleObj:{nodeName:"全国",id:0},newForm:{},popoverContent:""}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this._getUserList(),this._getTheaterList()},methods:{_getUserList:function(){var e=this;Object(s.e)().then(function(t){e.userList=t.data})},_getTheaterList:function(){var e=this;Object(s.d)().then(function(t){e.data=[t.data],e._getRightList()})},_getRightList:function(){var e=this;Object(s.o)(this.rightTitleObj.id).then(function(t){e.tableData=t.data})},getResourcesArr:function(e){return e.row.theaterResources.map(function(e){return e.cityName?e.cityName:e.provinceName}).join("、")},delNode:function(){var e=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.b)(e.rightTitleObj.id).then(function(t){e.visible=!1,e.dialogFormVisible=!1,e.rightTitleObj={nodeName:"全国",id:0},e._getTheaterList()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},getShowPopover:function(e){},getNode:function(e,t,r){this.rightTitleObj.nodeName=e.nodeName,this.rightTitleObj.id=e.id,this._getRightList()},edit:function(e){var t=this;switch(this.dialogFormVisible=!0,e){case"new":this.dialogTitle="编辑组织",Object(s.p)(this.rightTitleObj.id).then(function(e){var r=e.data,n=[],i=[];r.theaterResources.map(function(e){t.cityCode.push(e.cityCode),t.proviceCode.push(e.provinceCode),e.provinceCode?t.selList.map(function(t){t.code===e.provinceCode&&t.children.map(function(t){n.push([e.provinceCode,t.code])})}):i.push([e.cityCode.slice(0,2),e.cityCode])}),t.areaCodeList=[].concat(n,i),t.$set(t.newForm,"nodeName",r.nodeName),t.$set(t.newForm,"masterId",Number(r.masterId)),t.selAreaFun(t.areaCodeList)});break;default:this.closeDialog(),this.dialogFormVisible=!0,this.dialogTitle="新建下级组织"}},closeDialog:function(){this.dialogFormVisible=!1,this.newForm={},this.areaCodeList=[]},checkout:function(){var e=void 0;return this.$refs.form.validate(function(t){e=!!t}),e},save:function(){var e=this;return a()(i.a.mark(function t(){var r,n,o,a,l;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.checkout()){t.next=2;break}return t.abrupt("return");case 2:return e.dialogFormVisible=!1,r=e.newForm,n=r.nodeName,o=r.masterId,a={id:0,masterId:o,masterName:"",nodeName:n,parentId:e.rightTitleObj.id,cityCodeList:0===e.cityCode.length?null:e.cityCode,provinceCodeList:0===e.proviceCode.length?null:e.proviceCode},t.next=7,e.repetitionFilter(a.provinceCodeList,a.cityCodeList);case 7:l=t.sent,a.provinceCodeList=l.proviceCode,a.cityCodeList=l.cityCode,t.t0=e.dialogTitle,t.next="新建下级组织"===t.t0?13:15;break;case 13:return Object(s.t)(a).then(function(t){e._getTheaterList()}),t.abrupt("break",19);case 15:return a.id=e.rightTitleObj.id,a.parentId="",Object(s.c)(a).then(function(t){e.rightTitleObj.nodeName=a.nodeName,e._getTheaterList()}),t.abrupt("break",19);case 19:case"end":return t.stop()}},t,e)}))()},filterNode:function(e,t){return!e||t.nodeName&&-1!==t.nodeName.indexOf(e)}}},c=(r("Lcc+"),r("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"layout",attrs:{id:"warZone"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:8}},[r("div",[r("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),r("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{data:e.data,props:e.defaultProps,"filter-node-method":e.filterNode,"default-expand-all":""},on:{"node-click":e.getNode}})],1)]),e._v(" "),r("el-col",{attrs:{span:16}},[r("div",[r("div",{staticClass:"tab-head"},[r("el-row",[r("el-col",{attrs:{span:20}},[r("span",[e._v(e._s(e.rightTitleObj.nodeName))]),e._v(" "),r("el-button",{staticClass:"btn-form-sub",staticStyle:{width:"68px"},attrs:{type:"primary"},on:{click:function(t){e.edit("new")}}},[e._v("编辑")])],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-button",{staticClass:"btn-gradient",attrs:{type:"primary"},on:{click:function(t){e.edit("next")}}},[e._v("新建下级组织")])],1)],1)],1),e._v(" "),r("div",{staticClass:"container"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[r("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{"min-width":"120",prop:"nodeName",label:"组织名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"masterName",label:"负责人"}}),e._v(" "),r("el-table-column",{attrs:{label:"省/市","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("p",{on:{click:function(r){e.getShowPopover(t)}}},[e._v(e._s(e.getResourcesArr(t)))])]}}])}),e._v(" "),r("el-table-column",{attrs:{"min-width":"140",prop:"updateTime",label:"更新日期"}})],1)],1)])])],1),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogFormVisible,"show-close":!1,title:e.dialogTitle,width:"40%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e.rightTitleObj.id?r("el-popover",{staticClass:"min-width:100px;",attrs:{placement:"bottom-end"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("div",{staticStyle:{cursor:"pointer","text-align":"center"},on:{click:e.delNode}},[e._v("删除组织")]),e._v(" "),r("i",{directives:[{name:"show",rawName:"v-show",value:"编辑组织"===e.dialogTitle,expression:"dialogTitle === '编辑组织'"}],staticClass:"iconfont icondiandiandian",staticStyle:{position:"absolute",top:"20px",right:"20px"},attrs:{slot:"reference"},slot:"reference"})]):e._e(),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.newForm,rules:e.newFormRules,"label-position":"left"}},[r("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"部门名称",prop:"nodeName"}},[r("el-input",{style:{width:e.formInputWidth},attrs:{clearable:"",placeholder:"请输入"},model:{value:e.newForm.nodeName,callback:function(t){e.$set(e.newForm,"nodeName",t)},expression:"newForm.nodeName"}})],1),e._v(" "),r("el-form-item",{attrs:{"label-width":e.formLabelWidth,prop:"areaCodeList",label:"省/市"}},[r("el-cascader",{style:{width:e.formInputWidth},attrs:{options:e.selList,props:{multiple:!0,value:"code",label:"name"},placeholder:"请选择省份",filterable:"","collapse-tags":"",clearable:""},on:{change:e.selAreaFun},model:{value:e.areaCodeList,callback:function(t){e.areaCodeList=t},expression:"areaCodeList"}})],1),e._v(" "),r("el-form-item",{attrs:{"label-width":e.formLabelWidth,prop:"masterId",label:"负责人"}},[r("el-select",{style:{width:e.formInputWidth},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.newForm.masterId,callback:function(t){e.$set(e.newForm,"masterId",t)},expression:"newForm.masterId"}},e._l(e.userList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticClass:"el-button btn-default btn-cancel",on:{click:e.closeDialog}},[e._v("取消")]),e._v(" "),r("el-button",{class:["el-button","btn-default","btn-submit"],attrs:{loading:e.loadingFlag,type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},[],!1,null,"3ab2086a",null);u.options.__file="index.vue";t.default=u.exports}}]);