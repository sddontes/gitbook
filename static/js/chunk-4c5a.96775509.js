(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4c5a"],{"5OVc":function(t,e,a){},"6U1N":function(t,e,a){"use strict";var s=a("fsu2");a.n(s).a},"6aKk":function(t,e,a){"use strict";a.d(e,"p",function(){return i}),a.d(e,"r",function(){return n}),a.d(e,"q",function(){return l}),a.d(e,"o",function(){return o}),a.d(e,"n",function(){return r}),a.d(e,"v",function(){return c}),a.d(e,"a",function(){return u}),a.d(e,"k",function(){return d}),a.d(e,"h",function(){return h}),a.d(e,"l",function(){return m}),a.d(e,"m",function(){return p}),a.d(e,"b",function(){return b}),a.d(e,"d",function(){return f}),a.d(e,"c",function(){return g}),a.d(e,"e",function(){return v}),a.d(e,"j",function(){return y}),a.d(e,"g",function(){return _}),a.d(e,"f",function(){return x}),a.d(e,"s",function(){return A}),a.d(e,"i",function(){return C}),a.d(e,"t",function(){return j}),a.d(e,"u",function(){return F});var s=a("CcjM");function i(t){return Object(s.a)({url:"bzy-csg-settlement/settlementModel/pageList",method:"post",data:t})}function n(t){return Object(s.a)({url:"bzy-csg-settlement/settlementSubject/rule/pageList",method:"post",data:t})}function l(t){return Object(s.a)({url:"bzy-csg-settlement/settlementSubject/rule/detail/"+t,method:"get"})}function o(t){return Object(s.a)({url:"bzy-csg-settlement/bill/list",method:"post",data:t})}function r(t){return Object(s.a)({url:"bzy-csg-settlement/bill/queryBillDetail/"+t,method:"get"})}function c(t){return Object(s.a)({url:"bzy-csg-settlement/dataSync/serviceFeeExcel",method:"post",data:t})}function u(t){return Object(s.a)({url:"bzy-csg-settlement/settlementSubject/mini/achievement",method:"post",data:t})}function d(t){return Object(s.a)({url:"bzy-csg-settlement/billInfoAdjust/listByMultiselect",method:"post",data:t})}function h(t){return Object(s.a)({url:"bzy-csg-settlement/email/sendLog",method:"post",data:t})}function m(t){return Object(s.a)({url:"bzy-csg-settlement/paybill/pageList",method:"post",data:t})}function p(t){return Object(s.a)({url:"bzy-csg-settlement/email",method:"post",data:t})}function b(t){return Object(s.a)({url:"bzy-csg-settlement/billInfoAdjust/addBillInfoAdjust",method:"post",data:t})}function f(t){return Object(s.a)({url:"bzy-csg-settlement/billExtendConf?"+t,method:"get"})}function g(t){return Object(s.a)({url:"bzy-csg-settlement/billExtendConf",method:"post",data:t})}function v(t,e){return Object(s.a)({url:"bzy-csg-settlement/billExtendConf/"+t,data:e,method:"put",headers:{"Content-Type":"text/plain;charset=UTF-8"}})}function y(t){return Object(s.a)({url:"bzy-csg-settlement/dataSync/billExtend",method:"post",data:t})}function _(t){return Object(s.a)({url:"bzy-csg-settlement/billExtend/hierarchy",params:t,method:"get"})}function x(t){return Object(s.a)({url:"bzy-csg-settlement/billExtend/hotel",params:t,method:"get"})}function A(t){return Object(s.a)({url:"bzy-csg-settlement/settlementModel/list",data:t,method:"post"})}function C(t){return Object(s.a)({url:"bzy-csg-settlement/billInfoAdjust/importBillAdjustExcel",data:t,method:"post"})}function j(t){return Object(s.a)({url:"bzy-csg-settlement/transaction/payment",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}function F(t){return Object(s.a)({url:"bzy-csg-settlement/transaction/receipt",data:t,headers:{"Content-Type":"text/plain;charset=UTF-8"},method:"post"})}},MO4u:function(t,e,a){"use strict";var s={name:"FetchSuggestions",props:{hotelList:{type:Array,required:!0},searchTitle:{type:String,required:!0}},data:function(){return{code:"",searchCode:""}},methods:{blurSearch:function(){var t=this;if(this.code){var e=this.hotelList.find(function(e){return e.name===t.code||e.code===t.code});this.searchCode=e?e.code:this.code,this.$emit("getFetchCode",this.searchCode)}else this.$emit("getFetchCode",this.code)},handleSelect:function(t){this.searchCode=t.code,this.$emit("getFetchCode",this.searchCode)},querySearch:function(t,e){var a=this.hotelList;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return e.name.indexOf(t)>-1}}}},i=(a("aT9M"),a("KHd+")),n=Object(i.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-list-item"},[t.searchTitle?a("span",{staticStyle:{display:"inline-block",flex:"0 0 70px","margin-right":"10px","text-align":"right"}},[t._v(t._s(t.searchTitle))]):t._e(),t._v(" "),a("el-autocomplete",{staticStyle:{width:"168px",flex:"0 1 atuo"},attrs:{"fetch-suggestions":t.querySearch,clearable:"","value-key":"name",placeholder:"酒店名称/编号"},on:{select:t.handleSelect,blur:t.blurSearch,clear:t.blurSearch},nativeOn:{change:function(e){return t.blurSearch(e)}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1)},[],!1,null,"cff8e71e",null);n.options.__file="index.vue";e.a=n.exports},OMKw:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACdklEQVRYR+2Yv4sTQRTHv29AovgDrPQqGzltYpHMbCT2WongISLaWHnN/QFq7/0BNtpYidp4KNddn9PszEIwjT+uVyvh7kAjm3ky4sJmL5usyW4IYVNm58dn3ve9N28eYc5/lORrt9vLQoh1IroM4FjB/PvMvEVED6WUH4ftNQDY6XSWwzB8D+BkwWDJ5X/0+/2LjUbjc/LDAKDW+jURXQfw1lq76nnetyJBfd8/LYR4AuAaM28opVZGAhpj9pys1tqlouEikG63e6rX6zlD7Espj48DZDdASnnAN4u0pDEmdd8BkFEDS8AU5RbDglrrFhE185CZmbeVUpfia03tg0EQtJh5fgHzsNyoNaa2YAm48HmwjOKFl7iM4lLiKX2gvEmmNCBcMWKtRbLKcevORT046oCZALPcJMPqvETNtwRgDcANAGcA9Jl5h4g2ATyWUn4d+y5Oc9Ys9eAoQK31ChE9A3AixVq7RHS3Xq9vzPxVFwTBTWZ+AUCM8VXLzLeVUq/i4zJJPGkQGGOcrK6lMWA5a+3fkl8I0UqsvQvgfFzuogEfAbifPGD07o5cKvF9XUr5IPqvaMAvAM7+J2BXSnlhVoC/ARxymzlZPc/bHuYuvu83Y3L/klIemRXgTwCH//lbs1arvZsWMNfmkTHmA4BqbhLH2m9vKpXKarVa/T5pBLt5xph8gySvBmaUtF2aYeZPRDTQVhNCNMMwpGSaYeY9IjqXmmbcqWMt4CsAjk5iwfitorW+RUTPMybqO0qpl6mJehKYLHMcJICnSUtGc53lANxLwh2oZrJsNukYJ7cQYs1aezWWG3eEEJvW2mzFwqSbFznvDwSr4Th1V6xnAAAAAElFTkSuQmCC"},aT9M:function(t,e,a){"use strict";var s=a("5OVc");a.n(s).a},fsu2:function(t,e,a){},lNwJ:function(t,e,a){"use strict";a.r(e);var s=a("P2sY"),i=a.n(s),n=a("6aKk"),l=a("Q2AE"),o=a("MO4u"),r=a("t2Y8"),c=a("kkBN"),u={name:"ShopAssignRecord",components:{FetchSuggestions:o.a},mixins:[r.a],data:function(){return{PATH:"settle-accounts/adjust-bills",formLabelWidth:"100px",formInputWidth:"100px",dialogFormVisible:!1,imagePath:a("OMKw"),oosUrl:"",adjustSubitem:"",formData:{projectType:"4"},headers:{Authorization:"bearer"+Object(c.a)()},hotelList:[],searchForm:{hotelCodeOrName:"",batchNo:"",updater:""},batchNo:"",dataTypeList:[],importDataType:[],assigns:[],action:"",limit:1,loading:!1,currentPage:1,size:20,totalPages:1,total:0}},computed:{tempHref:function(){return"http://bzyadmin.hhotel.com/download/bzy-csg-settlement/bzy-csg-service-fee.xls"}},created:function(){this.action="https://bzy-fs.hhotel.com/bzy-file-server/uploadfile";var t=new Date,e=t.getMonth();t.getDate()>3?this.searchForm.batchNo=t.getFullYear()+""+(e>9?e:"0"+e):this.searchForm.batchNo=t.getFullYear()+""+(e-1>9?e-1:"0"+(e-1)),this._listByMultiselect(),this._getRemoteData(),this._billSubitemExtend()},methods:{search:function(){this.currentPage=1;var t=new Date,e=t.getFullYear(),a=t.getDate(),s=t.getMonth()+1;s<11&&!this.searchForm.batchNo||2019===e&&11===s&&a<4&&!this.searchForm.batchNo||("2019"===this.searchForm.batchNo.slice(0,4)&&this.searchForm.batchNo.slice(4)<10?this.$message.error("抱歉，此账期数据不支持查询 "):this._listByMultiselect())},getFetchCode:function(t){this.searchForm.hotelCodeOrName=t},_billSubitemExtend:function(){var t=this;Object(n.g)().then(function(e){t.dataTypeList=e;for(var a=0;a<t.dataTypeList.length;a++)0===t.dataTypeList[a].children.length?delete t.dataTypeList[a].children:t.dataTypeList[a].children.length&&t.dataTypeList[a].children[0].value===t.dataTypeList[a].value&&delete t.dataTypeList[a].children})},_listByMultiselect:function(){var t=this,e=i()(this.searchForm,{page:this.currentPage,size:this.size}),a=new Date,s=a.getFullYear(),l=a.getDate(),o=a.getMonth()+1;o<11&&!this.searchForm.batchNo||2019===s&&11===o&&l<4&&!this.searchForm.batchNo||"2019"===this.searchForm.batchNo.slice(0,4)&&this.searchForm.batchNo.slice(4)<10||(this.loading=!0,Object(n.k)(e).then(function(e){t.loading=!1,t.assigns=e.data.list,t.totalPages=e.data.pages,t.total=e.data.total}))},_getRemoteData:function(){var t=this;l.a.dispatch("getHotelList").then(function(e){t.hotelList=e})},_checkList:function(){},_toOperating:function(t){this.$router.push({path:"/settle-accounts/settle-accounts-costdetail",query:{billNo:t.billNo}})},handleSizeChange:function(t){this.size=t,this._listByMultiselect()},handleCurrentChange:function(t){this.currentPage=t,this._listByMultiselect()},handleSelectionChange:function(t){this.multipleSelection=t},_exportAdjustBillExcelTemp:function(){if(this.importDataType[0]){var t="http://bzy.hhotel.com/bzy-csg-settlement/file/billAdjust/exportAdjustBillExcelTemp?billInfoExtendType="+this.importDataType[0];window.open(encodeURI(t),"_blank")}else this.$message.error("请选择科目和子项")},importBillAdjustExcel:function(){var t=this;this.importDataType[1]=this.importDataType[1]?this.importDataType[1]:this.importDataType[0];var e={billInfoExtendType:this.importDataType[1],billInfoType:this.importDataType[0],url:this.oosUrl};this.importDataType[0]?this.oosUrl?Object(n.i)(e).then(function(e){t.$message({type:"success",message:e.message}),t._listByMultiselect(),t.$refs.upload.clearFiles(),t.dialogFormVisible=!1}):this.$message.error("请提交文件"):this.$message.error("请选择科目和子项")},handleExcelSuccess:function(t,e){this.oosUrl=t.data[0].filePath},uploadError:function(t){this.$message({type:"error",message:JSON.parse(t.message).message})},_exportExcel:function(){var t=i()({},this.searchForm),e="";for(var a in t)t[a]?e+="&"+a+"="+t[a]:e+="&"+a+"=";var s="http://bzy.hhotel.com/bzy-csg-settlement/billInfoAdjust/export?"+(e=e.substring(1));window.open(encodeURI(s),"_blank")},inputFileDialog:function(){this.dialogFormVisible=!0}}},d=(a("6U1N"),a("KHd+")),h=Object(d.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hotel layout",attrs:{id:"manager"}},[a("div",{staticClass:"tab-head"},[a("div",{staticClass:"tab-head-list"},[a("div",{staticClass:"el-row"},[a("div",{staticClass:"el-col el-col-22"},[a("div",{staticClass:"el-col"},[a("div",{staticClass:"tab-list-item"},[a("fetchSuggestions",{staticStyle:{width:"250px"},attrs:{"hotel-list":t.hotelList,"search-title":"结算方名称"},on:{getFetchCode:t.getFetchCode}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("所属账期")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"160px",float:"right","margin-left":"20px"},attrs:{type:"month",placeholder:"选择月份",format:"yyyy年MM月","value-format":"yyyyMM"},model:{value:t.searchForm.batchNo,callback:function(e){t.$set(t.searchForm,"batchNo",e)},expression:"searchForm.batchNo"}}),t._v(" "),a("span",{staticClass:"left_label"},[t._v("录入人")]),t._v(" "),a("el-input",{staticStyle:{width:"160px",float:"right","margin-left":"20px"},model:{value:t.searchForm.updater,callback:function(e){t.$set(t.searchForm,"updater",e)},expression:"searchForm.updater"}}),t._v(" "),a("span",{staticClass:"left_label"}),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)]),t._v(" "),a("div",{staticClass:"el-col"})])])])]),t._v(" "),a("div",{staticClass:"table-content"},[t.buttonFilter("settle-accounts",t.btnArr)?a("span",{staticClass:"float-right",on:{click:t._exportExcel}},[a("i",{staticClass:"iconfont iconic_download addIcon"}),t._v(" "),a("span",{attrs:{type:"primary"}},[t._v("导出")])]):t._e(),t._v(" "),t.buttonFilter("settle-accounts",t.btnArr)?a("span",{staticClass:"float-right",on:{click:t.inputFileDialog}},[a("i",{staticClass:"addIcon"},[t._v("+")]),t._v(" "),a("span",{attrs:{type:"primary"}},[t._v("批量录入")])]):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.assigns,"max-height":"500","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"hotelName",label:"调整单编号"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.adjustBatchNo))]),t._v(" "),a("p",[t._v(t._s(e.row.billNo))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"hotelName",label:"结算方"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.hotelName))]),t._v(" "),a("p",[t._v(t._s(e.row.hotelCode))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"settlementBatchNo",label:"结算账期"}}),t._v(" "),a("el-table-column",{attrs:{prop:"batchNo",label:"所属账期"}}),t._v(" "),a("el-table-column",{attrs:{label:"调整子项"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.billInfoName))]),t._v(" "),a("p",[t._v(t._s(e.row.billInfoExtendType))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"调整金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("￥"+t._s(t._f("ThousandNum")(e.row.amountExtend)))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"录入人"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.updater))]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"生效/提交时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",[t._v(t._s(e.row.validTime))]),t._v(" "),a("p",[t._v(t._s(e.row.createTime))])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"sum"},[t._v("共"+t._s(t.total)+"条记录")]),t._v(" "),a("div",{staticClass:"pagination-content"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,40,80,100],"page-size":t.size,"page-count":t.totalPages,layout:" sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("el-dialog",{staticClass:"publicDialog",attrs:{visible:t.dialogFormVisible,"show-close":!1,width:"40.6%",title:"调整单录入"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",[a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"调整子项",required:""}},[a("el-cascader",{staticStyle:{width:"250px"},attrs:{"show-all-levels":!1,options:t.dataTypeList,clearable:""},model:{value:t.importDataType,callback:function(e){t.importDataType=e},expression:"importDataType"}})],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"选择文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-error":t.uploadError,headers:t.headers,"on-success":t.handleExcelSuccess,"auto-upload":!0,action:t.action,data:t.formData,limit:t.limit,name:"files"}},[a("div",{staticClass:"viewFile"},[a("img",{attrs:{src:t.imagePath,alt:"浏览"}}),t._v(" "),a("p",{staticStyle:{padding:"0",margin:"0"}},[t._v("浏览")])])])],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"下载模板"}},[a("a",{staticStyle:{display:"inline-block",width:"98px",height:"32px","line-height":"32px",background:"rgba(0,96,114,0.1)","border-radius":"4px",color:"#006072","text-align":"center"},attrs:{target:"_blank"},on:{click:t._exportAdjustBillExcelTemp}},[t._v("下载模板")])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-dialog-sub",on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{staticClass:"btn-dialog-primary",attrs:{type:"primary"},on:{click:t.importBillAdjustExcel}},[t._v("提 交")])],1)],1)],1)},[],!1,null,"09dfdd9e",null);h.options.__file="adjustBills.vue";e.default=h.exports},t2Y8:function(t,e,a){"use strict";var s=a("QbLZ"),i=a.n(s),n=a("L2JU");function l(t,e){return e.includes(t)}e.a={computed:i()({},Object(n.b)(["name","btnPermissionRoles"])),created:function(){this._initBtnPermission()},methods:{_initBtnPermission:function(){var t=function(t,e){var a=[];if(t.length)return t.map(function(t){var s=t.split(":")[0],i=t.split(":")[1];s===e&&a.push(i)}),a}(this.btnPermissionRoles,this.PATH);this.btnArr=t,this.buttonFilter=l}}}}}]);