(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-bc8a"],{CbPT:function(t,e,a){"use strict";var i=a("xIFl");a.n(i).a},OMKw:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAACdklEQVRYR+2Yv4sTQRTHv29AovgDrPQqGzltYpHMbCT2WongISLaWHnN/QFq7/0BNtpYidp4KNddn9PszEIwjT+uVyvh7kAjm3ky4sJmL5usyW4IYVNm58dn3ve9N28eYc5/lORrt9vLQoh1IroM4FjB/PvMvEVED6WUH4ftNQDY6XSWwzB8D+BkwWDJ5X/0+/2LjUbjc/LDAKDW+jURXQfw1lq76nnetyJBfd8/LYR4AuAaM28opVZGAhpj9pys1tqlouEikG63e6rX6zlD7Espj48DZDdASnnAN4u0pDEmdd8BkFEDS8AU5RbDglrrFhE185CZmbeVUpfia03tg0EQtJh5fgHzsNyoNaa2YAm48HmwjOKFl7iM4lLiKX2gvEmmNCBcMWKtRbLKcevORT046oCZALPcJMPqvETNtwRgDcANAGcA9Jl5h4g2ATyWUn4d+y5Oc9Ys9eAoQK31ChE9A3AixVq7RHS3Xq9vzPxVFwTBTWZ+AUCM8VXLzLeVUq/i4zJJPGkQGGOcrK6lMWA5a+3fkl8I0UqsvQvgfFzuogEfAbifPGD07o5cKvF9XUr5IPqvaMAvAM7+J2BXSnlhVoC/ARxymzlZPc/bHuYuvu83Y3L/klIemRXgTwCH//lbs1arvZsWMNfmkTHmA4BqbhLH2m9vKpXKarVa/T5pBLt5xph8gySvBmaUtF2aYeZPRDTQVhNCNMMwpGSaYeY9IjqXmmbcqWMt4CsAjk5iwfitorW+RUTPMybqO0qpl6mJehKYLHMcJICnSUtGc53lANxLwh2oZrJsNukYJ7cQYs1aezWWG3eEEJvW2mzFwqSbFznvDwSr4Th1V6xnAAAAAElFTkSuQmCC"},VLRh:function(t,e,a){"use strict";a.d(e,"n",function(){return i}),a.d(e,"h",function(){return s}),a.d(e,"c",function(){return l}),a.d(e,"g",function(){return n}),a.d(e,"k",function(){return o}),a.d(e,"r",function(){return r}),a.d(e,"l",function(){return c}),a.d(e,"q",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"e",function(){return h}),a.d(e,"j",function(){return p}),a.d(e,"s",function(){return m}),a.d(e,"o",function(){return b}),a.d(e,"d",function(){return v}),a.d(e,"p",function(){return f}),a.d(e,"a",function(){return g}),a.d(e,"b",function(){return A}),a.d(e,"m",function(){return _}),a.d(e,"t",function(){return C}),a.d(e,"i",function(){return E});var i="SOLFT_GUARANTEE",s="LOGO_JOIN",l="BUSINESS_CONSULT",n="JOIN_GUARANTEE",o="OPERATIONING",r="WAIT_OPERATION",c="PAUSED",u="VERB",d="EAST_WEST_NORTH",h="EAST",p="NORTH",m="WEST_SOUTH",b="SOUTH",v="CENTRAL",f="UNALLOCATED",g="ALLOCATED",A="ARRIVED",_="PROPRIETOR_CONFIRMED",C="YEAR_GUARANTEE",E="MONTH_GUARANTEE"},s5D4:function(t,e,a){"use strict";a.r(e);var i=a("kkBN"),s=a("/uL/"),l=a("VLRh"),n={name:"HotelBudegImportIndex",mixins:[a("t2Y8").a],data:function(){return{dataType:"",PATH:"hotel-budeg-import/index",imagePath:a("OMKw"),action:null,tempHref:"http://bzyadmin.hhotel.com/download/budgetModel1.xlsx",status:0,dialogFormVisible:!1,headers:{Authorization:"bearer"+Object(i.a)()},formLabelWidth:"120px",limit:1,props:{value:"code",label:"name",checkStrictly:!0},code:null,size:20,currentPage:1,totalPages:1,hotelName:"",city:[],hotels:[],cityValue:[],totalElements:0,hotelStates:[{value:0,label:"全部"},{value:l.r,label:"待运营"},{value:l.k,label:"运营中"},{value:l.l,label:"已暂停"},{value:l.q,label:"已解约"}]}},computed:{dialogTitle:function(){return""+this.hotelName},loading:function(){return this.$store.getters.loading}},created:function(){this._getCity(),this._getAllPermissionHotel(),this.search(),this.currentPage=1,this.size=20},methods:{handleSizeChange:function(t){this.size=t,this._getHotel()},handleCurrentChange:function(t){this.currentPage=t,this._getHotel("pageChange")},search:function(){this.currentPage=1,this._getHotel()},selectCity:function(t){this.provinceCode=t[0]?[t[0]]:[],this.proviceCode=t[0]?[t[0]]:[],this.cityCode=t[1]?[t[1]]:[],this.areaCode=t[2]||""},getStyle:function(t){return["ARRIVED","PROPRIETOR_CONFIRMED","OPERATIONING"].includes(t)?"normal-text":["UNALLOCATED","PAUSED","VERB"].includes(t)?"error-text":void 0},getClass:function(t){return["ARRIVED","PROPRIETOR_CONFIRMED","OPERATIONING"].includes(t)?"normal-bg":["UNALLOCATED","PAUSED","VERB"].includes(t)?"error-bg":"no-bg"},querySearch:function(t,e){var a=this.hotelList;e(t?a.filter(this.createFilter(t)):a)},createFilter:function(t){return function(e){return e.name.indexOf(t)>-1}},goDetail:function(t){var e=this.$router.resolve({path:"/hotel-budeg-import/"+t.code+"?name="+t.name});window.open(e.href,"_blank")},importData:function(t,e){this.dataType=e,t&&t.code&&t.name&&(this.dialogFormVisible=!0,this.hotelCode=t.code,this.hotelName=t.name,this.action="http://bzy.hhotel.com/bzy-collection/excelData/budgetImport?hotelCode="+this.hotelCode+"&hotelName="+this.hotelName,this.dataType&&(this.action+="&dataType=ALTER"))},submitUpload:function(){this.$refs.upload.submit()},handleExcelSuccess:function(t,e){this.dataType?this.$message({type:"success",message:"上传成功！数据的清洗与计算会统一在次日凌晨进行。"}):this.$message({type:"success",message:"导入数据成功"}),this.$refs.upload.clearFiles(),this.dialogFormVisible=!1},uploadError:function(t){this.$message({type:"error",message:JSON.parse(t.message).message})},_getCity:function(){var t=this;Object(s.g)().then(function(e){t.city=e.data})},_getHotel:function(){var t=this,e={code:this.hotelName,page:this.currentPage,size:this.size,proviceCode:this.provinceCode,cityCode:this.cityCode,areaCode:this.areaCode,status:0===this.status?[]:[this.status]};Object(s.i)(e).then(function(e){t.hotels=e.data.list,t.totalElements=e.data.totalElements,t.totalPages=e.data.totalPages})},_getAllPermissionHotel:function(){var t=this;Object(s.i)({page:1,size:9999}).then(function(e){t.hotelList=e.data.list})}}},o=(a("CbPT"),a("KHd+")),r=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"budeg layout"},[a("div",{staticClass:"tab-head"},[a("div",{staticClass:"tab-head-list"},[a("el-row",[a("el-col",{attrs:{span:22}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("酒店")]),t._v(" "),a("el-autocomplete",{staticStyle:{width:"168px"},attrs:{"fetch-suggestions":t.querySearch,"value-key":"name",placeholder:"请输入"},model:{value:t.hotelName,callback:function(e){t.hotelName=e},expression:"hotelName"}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("城市")]),t._v(" "),a("el-cascader",{staticStyle:{width:"168px"},attrs:{options:t.city,props:t.props,clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.selectCity},model:{value:t.cityValue,callback:function(e){t.cityValue=e},expression:"cityValue"}})],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"tab-list-item"},[a("span",{staticClass:"left_label"},[t._v("酒店状态")]),t._v(" "),a("el-select",{staticStyle:{width:"168px"},attrs:{placeholder:"请选择"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.hotelStates,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])],1),t._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"tab-list-item"},[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"hr"})]),t._v(" "),a("div",{staticClass:"container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","border-radius":"6px"},attrs:{data:t.hotels,"max-height":"500","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{fixed:"",prop:"name",label:"酒店名称","min-width":"150"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"code",label:"酒店编号","min-width":"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"proviceName",label:"区域","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.proviceName)+" "+t._s(e.row.cityName))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"srn",label:"SRN","min-width":"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"statusCN",label:"合作状态","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:t.getClass(e.row.status),staticStyle:{display:"inline-block",width:"6px",height:"6px","border-radius":"3px"}}),t._v(" "),a("span",{class:t.getStyle(e.row.status)},[t._v(t._s(e.row.statusCN))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"signDate",label:"更新时间","min-width":"120"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.buttonFilter("ALTER",t.btnArr)?a("span",{staticClass:"btn_group",on:{click:function(a){t.importData(e.row,"ALTER")}}},[t._v("清洗数据")]):t._e(),t._v(" "),t.buttonFilter("ALTER",t.btnArr)?a("span",{staticClass:"btn_shu"},[t._v("|")]):t._e(),t._v(" "),t.buttonFilter("lead-in",t.btnArr)?a("span",{staticClass:"btn_group",on:{click:function(a){t.importData(e.row)}}},[t._v("导入数据")]):t._e(),t._v(" "),t.buttonFilter("lead-in",t.btnArr)?a("span",{staticClass:"btn_shu"},[t._v("|")]):t._e(),t._v(" "),t.buttonFilter("view",t.btnArr)?a("span",{staticClass:"btn_group",on:{click:function(a){t.goDetail(e.row)}}},[t._v("查看明细")]):t._e()]}}])})],1)],1),t._v(" "),a("div",{staticClass:"sum"},[t._v("共计"+t._s(t.totalElements)+"条")]),t._v(" "),a("div",{staticClass:"pagination-content"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[20,40,80,100],"page-size":t.size,"page-count":t.totalPages,layout:"sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogFormVisible,"show-close":!1,center:!0,title:"ALTER"===t.dataType?"清洗数据":"导入数据","custom-class":"importFile"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",[a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"酒店名称"}},[a("span",[t._v(t._s(t.dialogTitle))])]),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"选择文件"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"on-error":t.uploadError,headers:t.headers,"on-success":t.handleExcelSuccess,"auto-upload":!1,action:t.action,limit:t.limit}},[a("div",{staticClass:"viewFile"},[a("img",{attrs:{src:t.imagePath,alt:"浏览"}}),t._v(" "),a("p",{staticClass:"viewText"},[t._v("浏览")])])])],1),t._v(" "),a("el-form-item",{attrs:{"label-width":t.formLabelWidth,label:"下载模板"}},[a("a",{staticStyle:{display:"inline-block",width:"98px",height:"32px","line-height":"32px",background:"rgba(0,96,114,0.1)","border-radius":"4px",color:"#006072","text-align":"center"},attrs:{href:t.tempHref,target:"_blank"}},[t._v("下载模板")])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn-dialog-sub",on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{staticClass:"btn-dialog-primary",attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("保 存")])],1)],1)],1)},[],!1,null,"a5f9596e",null);r.options.__file="index.vue";e.default=r.exports},t2Y8:function(t,e,a){"use strict";var i=a("QbLZ"),s=a.n(i),l=a("L2JU");function n(t,e){return e.includes(t)}e.a={computed:s()({},Object(l.b)(["name","btnPermissionRoles"])),created:function(){this._initBtnPermission()},methods:{_initBtnPermission:function(){var t=function(t,e){var a=[];if(t.length)return t.map(function(t){var i=t.split(":")[0],s=t.split(":")[1];i===e&&a.push(s)}),a}(this.btnPermissionRoles,this.PATH);this.btnArr=t,this.buttonFilter=n}}}},xIFl:function(t,e,a){}}]);